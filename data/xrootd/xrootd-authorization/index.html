
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://osg-htc.org/docs/data/xrootd/xrootd-authorization/">
      
      <link rel="icon" href="../../../img/favicon.ico">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.2.8">
    
    
      
        <title>Configuring XRootD Authorization - OSG Site Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.644de097.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../css/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  


  <script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-69012-29","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){var e;this.value&&(e=document.location.pathname,ga("send","pageview",e+"?q="+this.value))}),"undefined"!=typeof location$&&location$.subscribe(function(e){ga("send","pageview",e.pathname)})})</script>
  <script async src="https://www.google-analytics.com/analytics.js"></script>


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#configuring-xrootd-authorization" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="OSG Site Documentation" class="md-header__button md-logo" aria-label="OSG Site Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            OSG Site Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Configuring XRootD Authorization
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/osg-htc/docs/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="OSG Site Documentation" class="md-nav__button md-logo" aria-label="OSG Site Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    OSG Site Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/osg-htc/docs/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../site-planning/" class="md-nav__link">
        Site Planning
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../site-verification/" class="md-nav__link">
        Site Verification
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../site-maintenance/" class="md-nav__link">
        Site Maintenance
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../common/help/" class="md-nav__link">
        Help / Security Incidents
      </a>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          Registration
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Registration" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Registration
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../common/contact-registration/" class="md-nav__link">
        Contact Information
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../common/registration/" class="md-nav__link">
        Resources and Collaborations
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_7">
          Resource Sharing
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Resource Sharing" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Resource Sharing
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_1" type="checkbox" id="__nav_7_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7_1">
          Compute
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Compute" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_1">
          <span class="md-nav__icon md-icon"></span>
          Compute
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../resource-sharing/overview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_1_2" type="checkbox" id="__nav_7_1_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7_1_2">
          Containers
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Containers" data-md-level="3">
        <label class="md-nav__title" for="__nav_7_1_2">
          <span class="md-nav__icon md-icon"></span>
          Containers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../resource-sharing/os-backfill-containers/" class="md-nav__link">
        OSPool Containers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../resource-sharing/user-containers/" class="md-nav__link">
        User Allocations
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_1_3" type="checkbox" id="__nav_7_1_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7_1_3">
          Compute Entrypoint
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Compute Entrypoint" data-md-level="3">
        <label class="md-nav__title" for="__nav_7_1_3">
          <span class="md-nav__icon md-icon"></span>
          Compute Entrypoint
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../compute-element/htcondor-ce-overview/" class="md-nav__link">
        HTCondor-CE Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../compute-element/hosted-ce/" class="md-nav__link">
        Request a Hosted CE
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../compute-element/install-htcondor-ce/" class="md-nav__link">
        Install HTCondor-CE
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_1_4" type="checkbox" id="__nav_7_1_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7_1_4">
          Worker Node
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Worker Node" data-md-level="3">
        <label class="md-nav__title" for="__nav_7_1_4">
          <span class="md-nav__icon md-icon"></span>
          Worker Node
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../worker-node/using-wn/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../worker-node/install-wn/" class="md-nav__link">
        Install from RPM
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../worker-node/install-wn-tarball/" class="md-nav__link">
        Install from Tarball
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../worker-node/install-wn-oasis/" class="md-nav__link">
        Install from OASIS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../worker-node/install-cvmfs/" class="md-nav__link">
        Install CVMFS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../worker-node/install-apptainer/" class="md-nav__link">
        Install Apptainer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../worker-node/using-wn-containers/" class="md-nav__link">
        Using WN Containers
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_2" type="checkbox" id="__nav_7_2" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_7_2">
          Data
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Data" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_2">
          <span class="md-nav__icon md-icon"></span>
          Data
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_2_1" type="checkbox" id="__nav_7_2_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7_2_1">
          HTTP & OASIS
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="HTTP & OASIS" data-md-level="3">
        <label class="md-nav__title" for="__nav_7_2_1">
          <span class="md-nav__icon md-icon"></span>
          HTTP & OASIS
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../run-frontier-squid-container/" class="md-nav__link">
        Running Frontier Squid in a Container
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../frontier-squid/" class="md-nav__link">
        Install Frontier Squid RPM
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../update-oasis/" class="md-nav__link">
        Update OASIS Shared Repo
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../external-oasis-repos/" class="md-nav__link">
        Install an OASIS Repo
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_2_2" type="checkbox" id="__nav_7_2_2" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_7_2_2">
          XRootD
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="XRootD" data-md-level="3">
        <label class="md-nav__title" for="__nav_7_2_2">
          <span class="md-nav__icon md-icon"></span>
          XRootD
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../overview/" class="md-nav__link">
        XRootD Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../install-standalone/" class="md-nav__link">
        Install XRootD Standalone
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Configure Authorization
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Configure Authorization
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#authorizing-bearer-tokens" class="md-nav__link">
    Authorizing Bearer Tokens
  </a>
  
    <nav class="md-nav" aria-label="Authorizing Bearer Tokens">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuring-scitokenswlcg-tokens" class="md-nav__link">
    Configuring SciTokens/WLCG Tokens
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuring-macaroons" class="md-nav__link">
    Configuring macaroons
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#authorizing-x509-proxies" class="md-nav__link">
    Authorizing X.509 proxies
  </a>
  
    <nav class="md-nav" aria-label="Authorizing X.509 proxies">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#authenticating-proxies" class="md-nav__link">
    Authenticating proxies
  </a>
  
    <nav class="md-nav" aria-label="Authenticating proxies">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mapping-subject-dns" class="md-nav__link">
    Mapping subject DNs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mapping-voms-attributes" class="md-nav__link">
    Mapping VOMS attributes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mapping-voms-attributes-to-users" class="md-nav__link">
    Mapping VOMS attributes to users
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#authorization-database" class="md-nav__link">
    Authorization database
  </a>
  
    <nav class="md-nav" aria-label="Authorization database">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formatting" class="md-nav__link">
    Formatting
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verifying-file-ownership-and-permissions" class="md-nav__link">
    Verifying file ownership and permissions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multiuser-and-the-authorization-database" class="md-nav__link">
    Multiuser and the authorization database
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#applying-authorization-changes" class="md-nav__link">
    Applying Authorization Changes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#verifying-xrootd-authorization" class="md-nav__link">
    Verifying XRootD Authorization
  </a>
  
    <nav class="md-nav" aria-label="Verifying XRootD Authorization">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bearer-tokens" class="md-nav__link">
    Bearer tokens
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#x509-and-voms-proxies" class="md-nav__link">
    X.509 and VOMS proxies
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#updating-to-osg-24" class="md-nav__link">
    Updating to OSG 24
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#updating-to-osg-23" class="md-nav__link">
    Updating to OSG 23
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../install-client/" class="md-nav__link">
        Using XRootD
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../install-cms-xcache/" class="md-nav__link">
        Install CMS XCache
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../install-shoveler/" class="md-nav__link">
        Install XRootD Shoveler
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_3" type="checkbox" id="__nav_7_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7_3">
          Other
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Other" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_3">
          <span class="md-nav__icon md-icon"></span>
          Other
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../other/configuration-with-osg-configure/" class="md-nav__link">
        Configuration with OSG-Configure
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../other/install-gwms-frontend/" class="md-nav__link">
        Install GlideinWMS Frontend
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../other/install-cvmfs-stratum1/" class="md-nav__link">
        Install a CVMFS Stratum 1
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../other/troubleshooting-gratia/" class="md-nav__link">
        Troubleshooting Gratia
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../other/schedd-filebeats/" class="md-nav__link">
        Install Transfer Log Filebeats
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../other/osg-token-renewer/" class="md-nav__link">
        Install OSG Token Renewal Service
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      
      
      
        <label class="md-nav__link" for="__nav_8">
          Access Point
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Access Point" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Access Point
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../submit/install-ospool-ap/" class="md-nav__link">
        Install an OSPool Access Point
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../submit/ap-ospool-aup/" class="md-nav__link">
        Acceptable Use Policy
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9" type="checkbox" id="__nav_9" >
      
      
      
      
        <label class="md-nav__link" for="__nav_9">
          Data Federation (OSDF)
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Data Federation (OSDF)" data-md-level="1">
        <label class="md-nav__title" for="__nav_9">
          <span class="md-nav__icon md-icon"></span>
          Data Federation (OSDF)
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../stashcache/overview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_2" type="checkbox" id="__nav_9_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_9_2">
          Data Cache
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Data Cache" data-md-level="2">
        <label class="md-nav__title" for="__nav_9_2">
          <span class="md-nav__icon md-icon"></span>
          Data Cache
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../osdf/install-cache-rpm/" class="md-nav__link">
        Install from RPM
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_3" type="checkbox" id="__nav_9_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_9_3">
          Data Cache (deprecated)
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Data Cache (deprecated)" data-md-level="2">
        <label class="md-nav__title" for="__nav_9_3">
          <span class="md-nav__icon md-icon"></span>
          Data Cache (deprecated)
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../stashcache/run-stashcache-container/" class="md-nav__link">
        Install from container
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../stashcache/install-cache/" class="md-nav__link">
        Install from RPM
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_4" type="checkbox" id="__nav_9_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_9_4">
          Data Origin
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Data Origin" data-md-level="2">
        <label class="md-nav__title" for="__nav_9_4">
          <span class="md-nav__icon md-icon"></span>
          Data Origin
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../stashcache/run-stash-origin-container/" class="md-nav__link">
        Install from container
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../stashcache/install-origin/" class="md-nav__link">
        Install from RPM
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../stashcache/vo-data/" class="md-nav__link">
        Publishing VO data
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_10" type="checkbox" id="__nav_10" >
      
      
      
      
        <label class="md-nav__link" for="__nav_10">
          Releases
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Releases" data-md-level="1">
        <label class="md-nav__title" for="__nav_10">
          <span class="md-nav__icon md-icon"></span>
          Releases
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../release/release_series/" class="md-nav__link">
        Release Series
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_10_2" type="checkbox" id="__nav_10_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_10_2">
          OSG 24
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="OSG 24" data-md-level="2">
        <label class="md-nav__title" for="__nav_10_2">
          <span class="md-nav__icon md-icon"></span>
          OSG 24
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../release/osg-24/" class="md-nav__link">
        News
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_10_3" type="checkbox" id="__nav_10_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_10_3">
          OSG 23
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="OSG 23" data-md-level="2">
        <label class="md-nav__title" for="__nav_10_3">
          <span class="md-nav__icon md-icon"></span>
          OSG 23
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../release/osg-23/" class="md-nav__link">
        News
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../release/updating-to-osg-23/" class="md-nav__link">
        Updating to OSG 23
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../release/supported_platforms/" class="md-nav__link">
        Supported Platforms
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../common/yum/" class="md-nav__link">
        OSG Yum Repos
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../release/yum-basics/" class="md-nav__link">
        Yum Basics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../release/signing/" class="md-nav__link">
        RPM Signing
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_11" type="checkbox" id="__nav_11" >
      
      
      
      
        <label class="md-nav__link" for="__nav_11">
          Tokens
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Tokens" data-md-level="1">
        <label class="md-nav__title" for="__nav_11">
          <span class="md-nav__icon md-icon"></span>
          Tokens
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../security/tokens/overview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../security/tokens/using-tokens/" class="md-nav__link">
        Using Tokens
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_12" type="checkbox" id="__nav_12" >
      
      
      
      
        <label class="md-nav__link" for="__nav_12">
          CA Certificates
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="CA Certificates" data-md-level="1">
        <label class="md-nav__title" for="__nav_12">
          <span class="md-nav__icon md-icon"></span>
          CA Certificates
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../common/ca/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../security/certificate-management/" class="md-nav__link">
        Certificate Management Reference
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_12_3" type="checkbox" id="__nav_12_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_12_3">
          Host Certificates
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Host Certificates" data-md-level="2">
        <label class="md-nav__title" for="__nav_12_3">
          <span class="md-nav__icon md-icon"></span>
          Host Certificates
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../security/host-certs/overview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../security/host-certs/incommon/" class="md-nav__link">
        Using InCommon
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../security/host-certs/lets-encrypt/" class="md-nav__link">
        Using Let's Encrypt
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#authorizing-bearer-tokens" class="md-nav__link">
    Authorizing Bearer Tokens
  </a>
  
    <nav class="md-nav" aria-label="Authorizing Bearer Tokens">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuring-scitokenswlcg-tokens" class="md-nav__link">
    Configuring SciTokens/WLCG Tokens
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuring-macaroons" class="md-nav__link">
    Configuring macaroons
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#authorizing-x509-proxies" class="md-nav__link">
    Authorizing X.509 proxies
  </a>
  
    <nav class="md-nav" aria-label="Authorizing X.509 proxies">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#authenticating-proxies" class="md-nav__link">
    Authenticating proxies
  </a>
  
    <nav class="md-nav" aria-label="Authenticating proxies">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mapping-subject-dns" class="md-nav__link">
    Mapping subject DNs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mapping-voms-attributes" class="md-nav__link">
    Mapping VOMS attributes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mapping-voms-attributes-to-users" class="md-nav__link">
    Mapping VOMS attributes to users
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#authorization-database" class="md-nav__link">
    Authorization database
  </a>
  
    <nav class="md-nav" aria-label="Authorization database">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formatting" class="md-nav__link">
    Formatting
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verifying-file-ownership-and-permissions" class="md-nav__link">
    Verifying file ownership and permissions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multiuser-and-the-authorization-database" class="md-nav__link">
    Multiuser and the authorization database
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#applying-authorization-changes" class="md-nav__link">
    Applying Authorization Changes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#verifying-xrootd-authorization" class="md-nav__link">
    Verifying XRootD Authorization
  </a>
  
    <nav class="md-nav" aria-label="Verifying XRootD Authorization">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bearer-tokens" class="md-nav__link">
    Bearer tokens
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#x509-and-voms-proxies" class="md-nav__link">
    X.509 and VOMS proxies
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#updating-to-osg-24" class="md-nav__link">
    Updating to OSG 24
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#updating-to-osg-23" class="md-nav__link">
    Updating to OSG 23
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
<a href="https://github.com/osg-htc/docs/edit/master/docs/data/xrootd/xrootd-authorization.md" title="Edit this page" class="md-content__button md-icon">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
</a>



<h1 id="configuring-xrootd-authorization">Configuring XRootD Authorization<a class="headerlink" href="#configuring-xrootd-authorization" title="Permanent link">&para;</a></h1>
<p>XRootD offers several authentication options using <a href="https://xrootd.slac.stanford.edu/doc/dev50/sec_config.htm">security plugins</a>
to validate incoming credentials, such as bearer tokens, X.509 proxies, and VOMS proxies.</p>
<p>In the case of X.509 and VOMS proxies, after the incoming credential has been mapped to a username or groupname, the
<a href="#authorization-database">authorization database</a> is used to provide fine-grained file access.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>On data nodes, files will be owned by Unix user <code>xrootd</code> (or other daemon user), not as the user
authenticated to, under most circumstances.
XRootD will verify the permissions and authorization based on the user that the security plugin authenticates you
to, but, internally, the data node files will be owned by the <code>xrootd</code> user. If this behaviour is not desired, enable
<a href="../install-standalone/#enabling-multi-user-support">XRootD multi-user support</a>. </p>
</div>
<h2 id="authorizing-bearer-tokens">Authorizing Bearer Tokens<a class="headerlink" href="#authorizing-bearer-tokens" title="Permanent link">&para;</a></h2>
<p>XRootD supports authorization of bearer tokens such as macaroons, SciTokens, or WLCG tokens.
Encoded in the bearer tokens themselves are information about the files that they should have read/write access to and
in the case of SciTokens and WLCG tokens, you may configure XRootD to further restrict access.</p>
<h3 id="configuring-scitokenswlcg-tokens">Configuring SciTokens/WLCG Tokens<a class="headerlink" href="#configuring-scitokenswlcg-tokens" title="Permanent link">&para;</a></h3>
<p>SciTokens and WLCG Tokens are asymmetrically signed bearer tokens: they are signed by a token issuer (e.g., CILogon, IAM)
and can be verified with the token issuer's public key.
To configure XRootD to accept tokens from a given token issuer use the following instructions:</p>
<ol>
<li>
<p>Add a section for each token issuer to <code>/etc/xrootd/scitokens.conf</code>:</p>
<div class="codehilite"><pre><span></span><code>[Issuer &lt;NAME&gt;]
issuer = &lt;URL&gt;
base_path = &lt;RELATIVE PATH&gt;
</code></pre></div>

<p>Replacing <code>&lt;NAME</code>&gt; with a descriptive name, <code>&lt;URL&gt;</code> with the token issuer URL, and <code>base_path</code> to a path relative to
<a href="../install-standalone/#configuring-xrootd"><code>rootdir</code></a> that the client should be restricted to accessing.</p>
</li>
<li>
<p><strong>(Optional)</strong> if you want to map the incoming token for a given issuer to a Unix username:</p>
<ol>
<li>
<p>Install <a href="../install-standalone/#enabling-multi-user-support">xrootd-multiuser</a></p>
</li>
<li>
<p>Add the following to the relevant issuer section in <code>/etc/xrootd/scitokens.conf</code>:</p>
<div class="codehilite"><pre><span></span><code>map_subject = True
</code></pre></div>

</li>
</ol>
</li>
<li>
<p><strong>(Optional)</strong> if you want to only accept tokens with the appropriate <code>aud</code> field, add the following to
    <code>/etc/xrootd/scitokens.conf</code>:</p>
<div class="codehilite"><pre><span></span><code>[Global]
audience = &lt;COMMMA SEPARATED LIST OF AUDIENCES&gt;
</code></pre></div>

</li>
</ol>
<p>An example configuration that supports tokens issued by the OSG Connect and CMS:</p>
<div class="highlight"><pre><span></span><code>[Global]
audience = https://testserver.example.com/, MySite

[Issuer OSG-Connect]

issuer = https://scitokens.org/osg-connect
base_path = /stash
map_subject = True

[Issuer CMS]

issuer = https://scitokens.org/cms
base_path = /user/cms
</code></pre></div>
<h3 id="configuring-macaroons">Configuring macaroons<a class="headerlink" href="#configuring-macaroons" title="Permanent link">&para;</a></h3>
<p>Macaroons are symetrically signed bearer tokens so your XRootD host must have access to the same secret key that is used
to sign incoming macaroons.
When used in an XRootD cluster, all data nodes and the redirector need access to the same secret.
To enable macaroon support:</p>
<ol>
<li>Place the shared secret in <code>/etc/xrootd/macaroon-secret</code></li>
<li>Ensure that it has the appropriate file ownership and permissions:<div class="codehilite"><pre><span></span><code><span class="gp">root@host # </span>chown xrootd:xrootd /etc/xrootd/macaroon-secret
<span class="gp">root@host # </span>chmod <span class="m">0600</span> /etc/xrootd/macaroon-secret
</code></pre></div>

</li>
</ol>
<h2 id="authorizing-x509-proxies">Authorizing X.509 proxies<a class="headerlink" href="#authorizing-x509-proxies" title="Permanent link">&para;</a></h2>
<h3 id="authenticating-proxies">Authenticating proxies<a class="headerlink" href="#authenticating-proxies" title="Permanent link">&para;</a></h3>
<p>Authorizations for proxy-based security are declared in an <a href="#authorization-database">XRootD authorization database file</a>.
XRootD authentication plugins are used to provide the mappings that are used in the database.</p>
<p>DN mappings are performed with XRootD's built-in GSI support,
and FQAN mappings are with the XRootD-VOMS (<code>XrdVoms</code>) plugin.</p>
<p>To enable proxy authentication, edit <code>/etc/xrootd/config.d/10-osg-xrdvoms.cfg</code> and add or uncomment the line</p>
<div class="highlight"><pre><span></span><code>set EnableVoms = 1
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Proxy authentication is already enabled in <a href="../install-standalone/">XRootD Standalone</a>,
so this step is not necessary there.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Requirements for XRootD-Multiuser with VOMS FQANs</p>
<p>Using XRootD-Multiuser with a VOMS FQAN requires XRootD 5.5.0 or newer.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Key length requirements</p>
<p>Servers on EL 8 or newer will reject proxies that are not at least 2048 bits long.
Ensure your clients' proxies have at least 2048 bits long with <code>voms-proxy-info</code>;
if necessary, have them add the argument <code>-bits 2048</code> to their <code>voms-proxy-init</code> calls.</p>
</div>
<h4 id="mapping-subject-dns">Mapping subject DNs<a class="headerlink" href="#mapping-subject-dns" title="Permanent link">&para;</a></h4>
<div class="admonition note">
<p class="admonition-title">DN mappings take precedence over VOMS attributes</p>
<p>If you have mapped the subject Distinguished Name (DN) of an incoming proxy with VOMS attributes,
XRootD will map it to a username.</p>
</div>
<p>X.509 proxies are mapped using the built-in XRootD GSI plug-in.
To map an incoming proxy's subject DN to an <a href="#authorization-database">XRootD username</a>,
add lines of the following format to <code>/etc/grid-security/grid-mapfile</code>:</p>
<div class="highlight"><pre><span></span><code>&quot;&lt;SUBJECT DN&gt;&quot; &lt;AUTHDB USERNAME&gt;
</code></pre></div>
<p>Replacing <code>&lt;SUBJECT DN&gt;</code> with the X.509 proxy's DN to map and <code>&lt;AUTHDB USERNAME&gt;</code> with the username to reference in the
<a href="#authorization-database">authorization database</a>.
For example, the following mapping:</p>
<div class="highlight"><pre><span></span><code>&quot;/DC=org/DC=cilogon/C=US/O=University of Wisconsin-Madison/CN=Brian Lin A2266246&quot; blin
</code></pre></div>
<p>Will result in the username <code>blin</code>,
i.e. authorize access to clients presenting the above proxy with <code>u blin ...</code> in the authorization database.</p>
<h4 id="mapping-voms-attributes">Mapping VOMS attributes<a class="headerlink" href="#mapping-voms-attributes" title="Permanent link">&para;</a></h4>
<div class="admonition warning">
<p class="admonition-title">Requirements for XRootD-Multiuser with VOMS FQANs</p>
<p>Using XRootD-Multiuser with a VOMS FQAN requires XRootD 5.5.0 or newer.</p>
</div>
<p>If the XRootD-VOMS plugin is enabled,
an incoming VOMS proxy will authenticate the first VOMS FQAN and map it to an organization name (<code>o</code>),
groupname (<code>g</code>), and role name (<code>r</code>) in the <a href="#authorization-database">authorization database</a>.
For example, a proxy from the OSPool whose first VOMS FQAN is <code>/osg/Role=NULL/Capability=NULL</code> will be authenticated to
the <code>/osg</code> groupname; note that the <code>/</code> <em>is</em> included in the groupname.</p>
<!-- XXX Which part of an FQAN ends up in "organization" ? -->

<p>Instead of only using the first VOMS FQAN, you can configure XRootD to consider all VOMS FQANs in the proxy for
authentication by setting the following in <code>/etc/xrootd/config.d/10-osg-xrdvoms.cfg</code>:</p>
<div class="highlight"><pre><span></span><code>set vomsfqans = useall
</code></pre></div>
<!-- XXX and how does this work? How can multiple FQANs be used? -->

<h4 id="mapping-voms-attributes-to-users">Mapping VOMS attributes to users<a class="headerlink" href="#mapping-voms-attributes-to-users" title="Permanent link">&para;</a></h4>
<p>In order for the XRootD-Multiuser plugin to work, a proxy must be mapped to a user (<code>u</code>) that is a valid Unix user.</p>
<p>Use a VOMS Mapfile, conventionally in <code>/etc/grid-security/voms-mapfile</code> that contains lines in the following form:
<div class="highlight"><pre><span></span><code>&quot;&lt;FQAN PATTERN&gt;&quot; &lt;USERNAME&gt;
</code></pre></div>
replacing <code>&lt;FQAN PATTERN&gt;</code> with a glob matching FQANs, and <code>&lt;USERNAME&gt;</code> with the user that you want to map
matching FQANs to.</p>
<p>For example,
<div class="highlight"><pre><span></span><code>&quot;/osg/*&quot; osg01
</code></pre></div>
will map FQANs starting with <code>/osg/</code> to the user <code>osg01</code>.</p>
<p>To enable using VOMS mapfiles in the first place, add the following line to your XRootD configuration:
<div class="highlight"><pre><span></span><code>voms.mapfile /etc/grid-security/voms-mapfile
</code></pre></div>
replacing <code>/etc/grid-security/voms-mapfile</code> with the actual location of your mapfile, if it is different.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A VOMS Mapfile only affects mapping the user (<code>u</code>) attribute understood in the <a href="#authorization-database">authorization-database</a>.
The FQAN will always be used for the groupname (<code>g</code>), organization name (<code>o</code>), and role name (<code>r</code>),
even if the mapfile is missing or does not contain a matching mapping.</p>
</div>
<p>See the <a href="https://github.com/xrootd/xrootd/tree/master/src/XrdVoms#voms-mapping">VOMS Mapping documentation</a> for details.
VOMS Mapfiles previously used with LCMAPS should continue to work unmodified,
but the plugin can only look at a single mapfile,
so if you are using the mappings provided in <code>/usr/share/osg/voms-mapfile-default</code>
(by the <code>vo-client-lcmaps-voms</code> package),
you will have to copy them to <code>/etc/grid-security/voms-mapfile</code>.</p>
<h3 id="authorization-database">Authorization database<a class="headerlink" href="#authorization-database" title="Permanent link">&para;</a></h3>
<p>XRootD allows configuring fine-grained file access permissions based on authenticated identities and paths.
This is configured in the authorization file <code>/etc/xrootd/Authfile</code>, which should be writable
only by the <code>xrootd</code> user, optionally readable by others.</p>
<p>Here is an example <code>/etc/xrootd/Authfile</code> :</p>
<div class="highlight"><pre><span></span><code># This means that all the users have read access to the datasets, _except_ under /private
<span class="hll">u * &lt;STORAGE PATH&gt;/private -rl &lt;STORAGE PATH&gt; rl
</span>
# Or the following, without a restricted /private dir
<span class="hll"># u * &lt;STORAGE PATH&gt; rl
</span>
# This means that all the users have full access to their private home dirs
<span class="hll">u = &lt;STORAGE PATH&gt;/home/@=/ a
</span>
# This means that the privileged &#39;xrootd&#39; user can do everything
# There must be at least one such user in order to create the
# private dirs for users willing to store their data in the facility
<span class="hll">u xrootd &lt;STORAGE PATH&gt; a
</span>
# This means that OSPool clients presenting a VOMS proxy can do anything under the &#39;osg&#39; directory
<span class="hll">g /osg &lt;STORAGE PATH&gt;/osg a
</span></code></pre></div>
<p>Replacing <code>&lt;STORAGE PATH&gt;</code> with the path to the directory that will contain data served by XRootD, e.g. <code>/data/xrootdfs</code>.
This path is relative to the <a href="../install-standalone/#configuring-xrootd"><code>rootdir</code></a>.</p>
<div class="admonition warning">
<p class="admonition-title">Configure most to least specific paths</p>
<p>Specific paths need to be specified <em>before</em> generic paths.
For example, this line will allow all users to read the contents <code>/data/xrootdfs/private</code>:</p>
<div class="codehilite"><pre><span></span><code>    u * /data/xrootdfs rl /data/xrootdfs/private -rl
</code></pre></div>

<p>Instead, specify the following to ensure that a given user will not be able to read the contents of
<code>/data/xrootdfs/private</code> unless specified with another authorization rule:</p>
<div class="codehilite"><pre><span></span><code>    u * /data/xrootdfs/private -rl /data/xrootdfs rl
</code></pre></div>

</div>
<h4 id="formatting">Formatting<a class="headerlink" href="#formatting" title="Permanent link">&para;</a></h4>
<p>More generally, each authorization rule of the authorization database has the following form:</p>
<div class="highlight"><pre><span></span><code>idtype id path privs
</code></pre></div>
<table>
<thead>
<tr>
<th>Field</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>idtype</td>
<td>Type of id. Use <code>u</code> for username, <code>g</code> for groupname, <code>o</code> for organization name, <code>r</code> for role name, etc.</td>
</tr>
<tr>
<td>id</td>
<td>ID name, e.g. username or groupname. Use <code>*</code> for all users or <code>=</code> for user-specific capabilities, like home directories</td>
</tr>
<tr>
<td>path</td>
<td>The path prefix to be used for matching purposes.  <code>@=</code> expands to the current user name before a path prefix match is attempted</td>
</tr>
<tr>
<td>privs</td>
<td>Letter list of privileges: <code>a</code> - all ; <code>l</code> - lookup ; <code>d</code> - delete ; <code>n</code> - rename ; <code>i</code> - insert ; <code>r</code> - read ; <code>k</code> - lock (not used) ; <code>w</code> - write ; <code>-</code> - prefix to remove specified privileges</td>
</tr>
</tbody>
</table>
<p>For more details or examples on how to use templated user options, see
<a href="http://xrootd.org/doc/dev47/sec_config.htm#_Toc489606599">XRootD authorization database</a>.</p>
<h4 id="verifying-file-ownership-and-permissions">Verifying file ownership and permissions<a class="headerlink" href="#verifying-file-ownership-and-permissions" title="Permanent link">&para;</a></h4>
<p>Ensure the authorization datbase file is owned by <code>xrootd</code> (if you have created file as root),
and that it is not writable by others.</p>
<div class="highlight"><pre><span></span><code><span class="gp">root@host # </span>chown xrootd:xrootd /etc/xrootd/Authfile
<span class="gp">root@host # </span>chmod <span class="m">0640</span> /etc/xrootd/Authfile  <span class="c1"># or 0644</span>
</code></pre></div>
<h3 id="multiuser-and-the-authorization-database">Multiuser and the authorization database<a class="headerlink" href="#multiuser-and-the-authorization-database" title="Permanent link">&para;</a></h3>
<p>The XRootD-Multiuser plugin can be used to perform file system operations as a different user than the XRootD daemon (whose user is <code>xrootd</code>).
If it is enabled, then <em>after</em> authorization is done using the authorization database,
XRootD will take the user (<code>u</code>) attribute of the incoming request, and perform file operations as the Unix user with the same name as that attribute.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If there is no Unix user with a matching name, you will see an error like
<code>XRootD mapped request to username that does not exist: &lt;username&gt;</code>; the operation will then fail with "EACCES" (access denied).</p>
</div>
<h2 id="applying-authorization-changes">Applying Authorization Changes<a class="headerlink" href="#applying-authorization-changes" title="Permanent link">&para;</a></h2>
<p>After making changes to your <a href="#authorization-database">authorization database</a>, you must restart the
<a href="../install-standalone/#using-xrootd">relevant services</a>.</p>
<h2 id="verifying-xrootd-authorization">Verifying XRootD Authorization<a class="headerlink" href="#verifying-xrootd-authorization" title="Permanent link">&para;</a></h2>
<h3 id="bearer-tokens">Bearer tokens<a class="headerlink" href="#bearer-tokens" title="Permanent link">&para;</a></h3>
<p>To test read access using macaroon, SciTokens, and WLCG token authorization, run the following command:</p>
<div class="highlight"><pre><span></span><code><span class="gp">user@host $ </span>curl -v <span class="se">\</span>
                 -H <span class="s1">&#39;Authorization: Bearer &lt;TOKEN&gt;&#39;</span> <span class="se">\</span>
                 https://host.example.com//path/to/directory/hello_world
</code></pre></div>
<p>Replacing <code>&lt;TOKEN&gt;</code> with the contents of your encoded token, <code>host.example.com</code> with the target XRootD host, and
<code>/path/to/directory/hello_world</code> with the path of the file to read.</p>
<p>To test write access, using macaroon, SciTokens, and WLCG token authorization, run the following command:</p>
<div class="highlight"><pre><span></span><code><span class="gp">user@host $ </span>curl -v <span class="se">\</span>
                 -X PUT <span class="se">\</span>
                 --upload-file &lt;FILE TO UPLOAD&gt; <span class="se">\</span>
                 -H <span class="s1">&#39;Authorization: Bearer &lt;TOKEN&gt;&#39;</span> <span class="se">\</span>
                 https://host.example.com//path/to/directory/hello_world
</code></pre></div>
<p>Replacing <code>&lt;TOKEN&gt;</code> with the contents of your encoded token, <code>&lt;FILE TO UPLOAD&gt;</code> with the file to write to the XRootD
host, <code>host.example.com</code> with the target XRootD host, and <code>/path/to/directory/hello_world</code> with the path of the file to
write.</p>
<h3 id="x509-and-voms-proxies">X.509 and VOMS proxies<a class="headerlink" href="#x509-and-voms-proxies" title="Permanent link">&para;</a></h3>
<p>To verify X.509 and VOMS proxy authorization, run the following commands from a machine with your user certificate/key
pair, <code>xrootd-client</code>, and <code>voms-clients-cpp</code> installed:</p>
<ol>
<li>
<p>Destroy any pre-existing proxies and attempt a copy to a directory (which we will refer to as <code>&lt;DESTINATION PATH&gt;</code>)
    on the <code>&lt;XROOTD HOST&gt;</code> to verify failure:</p>
<div class="codehilite"><pre><span></span><code><span class="gp">user@client $ </span>voms-proxy-destroy
<span class="gp">user@client $ </span>xrdcp /bin/bash root://&lt;XROOTD HOST&gt;/&lt;DESTINATION PATH&gt;
<span class="go">180213 13:56:49 396570 cryptossl_X509CreateProxy: EEC certificate has expired</span>
<span class="go">[0B/0B][100%][==================================================][0B/s]</span>
<span class="go">Run: [FATAL] Auth failed</span>
</code></pre></div>

</li>
<li>
<p>On the XRootD host, add your DN to <a href="#mapping-subject-dns">/etc/grid-security/grid-mapfile</a></p>
</li>
<li>
<p>Add a line to the <a href="#authorization-database">authorization database</a> to ensure the mapped user can write to
    <code>&lt;DESTINATION PATH&gt;</code></p>
</li>
<li>
<p>Restart the relevant XRootD services.
    See <a href="../install-standalone/#using-xrootd">this section</a> for details</p>
</li>
<li>
<p>Generate your proxy and verify that you can successfully transfer files:</p>
<div class="codehilite"><pre><span></span><code><span class="gp">user@client $ </span>voms-proxy-init
<span class="gp">user@client $ </span>xrdcp  /bin/sh root://&lt;XROOTD HOST&gt;/&lt;DESTINATION PATH&gt;
<span class="go">[938.1kB/938.1kB][100%][==================================================][938.1kB/s]</span>
</code></pre></div>

<p>If your transfer does not succeed, re-run <code>xrdcp</code>  with <code>--debug 2</code> for more information.</p>
</li>
</ol>
<h2 id="updating-to-osg-24">Updating to OSG 24<a class="headerlink" href="#updating-to-osg-24" title="Permanent link">&para;</a></h2>
<p>There are no manual steps necessary for authentication to work when upgrading from OSG 23 to OSG 24.</p>
<h2 id="updating-to-osg-23">Updating to OSG 23<a class="headerlink" href="#updating-to-osg-23" title="Permanent link">&para;</a></h2>
<p>There are no manual steps necessary for authentication to work when upgrading from OSG 3.6 to OSG 23.</p>

              
            </article>
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" data-md-state="hidden">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../install-standalone/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Install XRootD Standalone" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Install XRootD Standalone
            </div>
          </div>
        </a>
      
      
        
        <a href="../install-client/" class="md-footer__link md-footer__link--next" aria-label="Next: Using XRootD" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Using XRootD
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div>
    This material is based upon work supported by the
    <a href="https://nsf.gov">National Science Foundation</a>
    under Grant Nos.
    <a href="https://www.nsf.gov/awardsearch/showAward?AWD_ID=1148698">1148698</a>
    ,
    <a href="https://www.nsf.gov/awardsearch/showAward?AWD_ID=1836650">1836650</a>
    , and
    <a href="https://www.nsf.gov/awardsearch/showAward?AWD_ID=2030508">2030508</a>
    . Any opinions, findings, and conclusions or recommendations expressed in this material are those of the author(s) and do not necessarily reflect the views of the National Science Foundation.
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
        Material for MkDocs
    </a>
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.sections", "navigation.top"], "search": "../../../assets/javascripts/workers/search.5e67fbfe.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.c44cc438.min.js"></script>
      
    
  </body>
</html>