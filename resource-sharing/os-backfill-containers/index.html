
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://osg-htc.org/docs/resource-sharing/os-backfill-containers/">
      
      <link rel="icon" href="../../img/favicon.ico">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.2.8">
    
    
      
        <title>Open Science Pool Containers - OSG Site Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.644de097.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  


  <script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-69012-29","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){var e;this.value&&(e=document.location.pathname,ga("send","pageview",e+"?q="+this.value))}),"undefined"!=typeof location$&&location$.subscribe(function(e){ga("send","pageview",e.pathname)})})</script>
  <script async src="https://www.google-analytics.com/analytics.js"></script>


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#open-science-pool-containers" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="OSG Site Documentation" class="md-header__button md-logo" aria-label="OSG Site Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            OSG Site Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Open Science Pool Containers
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/osg-htc/docs/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="OSG Site Documentation" class="md-nav__button md-logo" aria-label="OSG Site Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    OSG Site Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/osg-htc/docs/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../site-planning/" class="md-nav__link">
        Site Planning
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../site-verification/" class="md-nav__link">
        Site Verification
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../site-maintenance/" class="md-nav__link">
        Site Maintenance
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../common/help/" class="md-nav__link">
        Help / Security Incidents
      </a>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          Registration
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Registration" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Registration
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../common/contact-registration/" class="md-nav__link">
        Contact Information
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../common/registration/" class="md-nav__link">
        Resources and Collaborations
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_7">
          Resource Sharing
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Resource Sharing" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Resource Sharing
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_1" type="checkbox" id="__nav_7_1" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_7_1">
          Compute
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Compute" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_1">
          <span class="md-nav__icon md-icon"></span>
          Compute
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../overview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_1_2" type="checkbox" id="__nav_7_1_2" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_7_1_2">
          Containers
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Containers" data-md-level="3">
        <label class="md-nav__title" for="__nav_7_1_2">
          <span class="md-nav__icon md-icon"></span>
          Containers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          OSPool Containers
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        OSPool Containers
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#before-starting" class="md-nav__link">
    Before Starting
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-the-container-via-rpm" class="md-nav__link">
    Running the Container via RPM
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-the-container-with-docker" class="md-nav__link">
    Running the Container with Docker
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#optional-configuration" class="md-nav__link">
    Optional Configuration
  </a>
  
    <nav class="md-nav" aria-label="Optional Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cvmfs" class="md-nav__link">
    CVMFS
  </a>
  
    <nav class="md-nav" aria-label="CVMFS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cvmfsexec" class="md-nav__link">
    cvmfsexec
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bind-mount" class="md-nav__link">
    Bind mount
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#providing-gpu-resources" class="md-nav__link">
    Providing GPU Resources
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#limiting-resource-usage" class="md-nav__link">
    Limiting resource usage
  </a>
  
    <nav class="md-nav" aria-label="Limiting resource usage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cpus" class="md-nav__link">
    CPUs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#memory" class="md-nav__link">
    Memory
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#advanced-advertising-additional-pilot-attributes" class="md-nav__link">
    Advanced: Advertising additional pilot attributes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#best-practices" class="md-nav__link">
    Best Practices
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#getting-help" class="md-nav__link">
    Getting Help
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user-containers/" class="md-nav__link">
        User Allocations
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_1_3" type="checkbox" id="__nav_7_1_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7_1_3">
          Compute Entrypoint
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Compute Entrypoint" data-md-level="3">
        <label class="md-nav__title" for="__nav_7_1_3">
          <span class="md-nav__icon md-icon"></span>
          Compute Entrypoint
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../compute-element/htcondor-ce-overview/" class="md-nav__link">
        HTCondor-CE Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../compute-element/hosted-ce/" class="md-nav__link">
        Request a Hosted CE
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../compute-element/install-htcondor-ce/" class="md-nav__link">
        Install HTCondor-CE
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_1_4" type="checkbox" id="__nav_7_1_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7_1_4">
          Worker Node
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Worker Node" data-md-level="3">
        <label class="md-nav__title" for="__nav_7_1_4">
          <span class="md-nav__icon md-icon"></span>
          Worker Node
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../worker-node/using-wn/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../worker-node/install-wn/" class="md-nav__link">
        Install from RPM
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../worker-node/install-wn-tarball/" class="md-nav__link">
        Install from Tarball
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../worker-node/install-wn-oasis/" class="md-nav__link">
        Install from OASIS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../worker-node/install-cvmfs/" class="md-nav__link">
        Install CVMFS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../worker-node/install-apptainer/" class="md-nav__link">
        Install Apptainer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../worker-node/using-wn-containers/" class="md-nav__link">
        Using WN Containers
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_2" type="checkbox" id="__nav_7_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7_2">
          Data
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Data" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_2">
          <span class="md-nav__icon md-icon"></span>
          Data
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_2_1" type="checkbox" id="__nav_7_2_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7_2_1">
          HTTP & OASIS
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="HTTP & OASIS" data-md-level="3">
        <label class="md-nav__title" for="__nav_7_2_1">
          <span class="md-nav__icon md-icon"></span>
          HTTP & OASIS
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/run-frontier-squid-container/" class="md-nav__link">
        Running Frontier Squid in a Container
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/frontier-squid/" class="md-nav__link">
        Install Frontier Squid RPM
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/update-oasis/" class="md-nav__link">
        Update OASIS Shared Repo
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/external-oasis-repos/" class="md-nav__link">
        Install an OASIS Repo
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_2_2" type="checkbox" id="__nav_7_2_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7_2_2">
          XRootD
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="XRootD" data-md-level="3">
        <label class="md-nav__title" for="__nav_7_2_2">
          <span class="md-nav__icon md-icon"></span>
          XRootD
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/xrootd/overview/" class="md-nav__link">
        XRootD Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/xrootd/install-standalone/" class="md-nav__link">
        Install XRootD Standalone
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/xrootd/xrootd-authorization/" class="md-nav__link">
        Configure Authorization
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/xrootd/install-client/" class="md-nav__link">
        Using XRootD
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/xrootd/install-cms-xcache/" class="md-nav__link">
        Install CMS XCache
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/xrootd/install-shoveler/" class="md-nav__link">
        Install XRootD Shoveler
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_3" type="checkbox" id="__nav_7_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7_3">
          Other
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Other" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_3">
          <span class="md-nav__icon md-icon"></span>
          Other
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../other/configuration-with-osg-configure/" class="md-nav__link">
        Configuration with OSG-Configure
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../other/install-gwms-frontend/" class="md-nav__link">
        Install GlideinWMS Frontend
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../other/install-cvmfs-stratum1/" class="md-nav__link">
        Install a CVMFS Stratum 1
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../other/troubleshooting-gratia/" class="md-nav__link">
        Troubleshooting Gratia
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../other/schedd-filebeats/" class="md-nav__link">
        Install Transfer Log Filebeats
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../other/osg-token-renewer/" class="md-nav__link">
        Install OSG Token Renewal Service
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      
      
      
        <label class="md-nav__link" for="__nav_8">
          Access Point
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Access Point" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Access Point
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../submit/install-ospool-ap/" class="md-nav__link">
        Install an OSPool Access Point
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../submit/ap-ospool-aup/" class="md-nav__link">
        Acceptable Use Policy
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9" type="checkbox" id="__nav_9" >
      
      
      
      
        <label class="md-nav__link" for="__nav_9">
          Data Federation (OSDF)
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Data Federation (OSDF)" data-md-level="1">
        <label class="md-nav__title" for="__nav_9">
          <span class="md-nav__icon md-icon"></span>
          Data Federation (OSDF)
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/stashcache/overview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_2" type="checkbox" id="__nav_9_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_9_2">
          Data Cache
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Data Cache" data-md-level="2">
        <label class="md-nav__title" for="__nav_9_2">
          <span class="md-nav__icon md-icon"></span>
          Data Cache
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/osdf/install-cache-container/" class="md-nav__link">
        Install from container
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/osdf/install-cache-rpm/" class="md-nav__link">
        Install from RPM
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_3" type="checkbox" id="__nav_9_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_9_3">
          Data Origin
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Data Origin" data-md-level="2">
        <label class="md-nav__title" for="__nav_9_3">
          <span class="md-nav__icon md-icon"></span>
          Data Origin
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/osdf/install-origin-rpm/" class="md-nav__link">
        Install from RPM
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_4" type="checkbox" id="__nav_9_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_9_4">
          Data Cache (deprecated)
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Data Cache (deprecated)" data-md-level="2">
        <label class="md-nav__title" for="__nav_9_4">
          <span class="md-nav__icon md-icon"></span>
          Data Cache (deprecated)
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/stashcache/run-stashcache-container/" class="md-nav__link">
        Install from container
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/stashcache/install-cache/" class="md-nav__link">
        Install from RPM
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_5" type="checkbox" id="__nav_9_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_9_5">
          Data Origin (deprecated)
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Data Origin (deprecated)" data-md-level="2">
        <label class="md-nav__title" for="__nav_9_5">
          <span class="md-nav__icon md-icon"></span>
          Data Origin (deprecated)
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/stashcache/run-stash-origin-container/" class="md-nav__link">
        Install from container
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/stashcache/install-origin/" class="md-nav__link">
        Install from RPM
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/stashcache/vo-data/" class="md-nav__link">
        Publishing VO data
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_10" type="checkbox" id="__nav_10" >
      
      
      
      
        <label class="md-nav__link" for="__nav_10">
          Releases
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Releases" data-md-level="1">
        <label class="md-nav__title" for="__nav_10">
          <span class="md-nav__icon md-icon"></span>
          Releases
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../release/release_series/" class="md-nav__link">
        Release Series
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_10_2" type="checkbox" id="__nav_10_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_10_2">
          OSG 24
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="OSG 24" data-md-level="2">
        <label class="md-nav__title" for="__nav_10_2">
          <span class="md-nav__icon md-icon"></span>
          OSG 24
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../release/osg-24/" class="md-nav__link">
        News
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../release/updating-to-osg-24/" class="md-nav__link">
        Updating to OSG 24
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_10_3" type="checkbox" id="__nav_10_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_10_3">
          OSG 23
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="OSG 23" data-md-level="2">
        <label class="md-nav__title" for="__nav_10_3">
          <span class="md-nav__icon md-icon"></span>
          OSG 23
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../release/osg-23/" class="md-nav__link">
        News
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../release/updating-to-osg-23/" class="md-nav__link">
        Updating to OSG 23
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../release/supported_platforms/" class="md-nav__link">
        Supported Platforms
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../common/yum/" class="md-nav__link">
        OSG Yum Repos
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../release/yum-basics/" class="md-nav__link">
        Yum Basics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../release/signing/" class="md-nav__link">
        RPM Signing
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_11" type="checkbox" id="__nav_11" >
      
      
      
      
        <label class="md-nav__link" for="__nav_11">
          Tokens
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Tokens" data-md-level="1">
        <label class="md-nav__title" for="__nav_11">
          <span class="md-nav__icon md-icon"></span>
          Tokens
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../security/tokens/overview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../security/tokens/using-tokens/" class="md-nav__link">
        Using Tokens
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_12" type="checkbox" id="__nav_12" >
      
      
      
      
        <label class="md-nav__link" for="__nav_12">
          CA Certificates
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="CA Certificates" data-md-level="1">
        <label class="md-nav__title" for="__nav_12">
          <span class="md-nav__icon md-icon"></span>
          CA Certificates
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../common/ca/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../security/certificate-management/" class="md-nav__link">
        Certificate Management Reference
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_12_3" type="checkbox" id="__nav_12_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_12_3">
          Host Certificates
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Host Certificates" data-md-level="2">
        <label class="md-nav__title" for="__nav_12_3">
          <span class="md-nav__icon md-icon"></span>
          Host Certificates
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../security/host-certs/overview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../security/host-certs/incommon/" class="md-nav__link">
        Using InCommon
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../security/host-certs/lets-encrypt/" class="md-nav__link">
        Using Let's Encrypt
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#before-starting" class="md-nav__link">
    Before Starting
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-the-container-via-rpm" class="md-nav__link">
    Running the Container via RPM
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-the-container-with-docker" class="md-nav__link">
    Running the Container with Docker
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#optional-configuration" class="md-nav__link">
    Optional Configuration
  </a>
  
    <nav class="md-nav" aria-label="Optional Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cvmfs" class="md-nav__link">
    CVMFS
  </a>
  
    <nav class="md-nav" aria-label="CVMFS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cvmfsexec" class="md-nav__link">
    cvmfsexec
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bind-mount" class="md-nav__link">
    Bind mount
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#providing-gpu-resources" class="md-nav__link">
    Providing GPU Resources
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#limiting-resource-usage" class="md-nav__link">
    Limiting resource usage
  </a>
  
    <nav class="md-nav" aria-label="Limiting resource usage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cpus" class="md-nav__link">
    CPUs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#memory" class="md-nav__link">
    Memory
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#advanced-advertising-additional-pilot-attributes" class="md-nav__link">
    Advanced: Advertising additional pilot attributes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#best-practices" class="md-nav__link">
    Best Practices
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#getting-help" class="md-nav__link">
    Getting Help
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
<a href="https://github.com/osg-htc/docs/edit/master/docs/resource-sharing/os-backfill-containers.md" title="Edit this page" class="md-content__button md-icon">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
</a>



<h1 id="open-science-pool-containers">Open Science Pool Containers<a class="headerlink" href="#open-science-pool-containers" title="Permanent link">&para;</a></h1>
<div class="admonition info">
<p class="admonition-title">Schedule a consultation</p>
<p>To ensure that we can meet your research computing goals needs, please contact us at <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#115;&#117;&#112;&#112;&#111;&#114;&#116;&#64;&#111;&#115;&#103;&#45;&#104;&#116;&#99;&#46;&#111;&#114;&#103;">&#115;&#117;&#112;&#112;&#111;&#114;&#116;&#64;&#111;&#115;&#103;&#45;&#104;&#116;&#99;&#46;&#111;&#114;&#103;</a> to schedule a consultation.</p>
</div>
<p>In order to <a href="../overview/">share compute resources</a> with the Open Science Pool (OSPool),
sites can launch pilot jobs directly by starting an OSG-provided Docker container.
The container includes a worker node environment and an embedded pilot;
when combined with an OSG-provided authentication token (not included in the container),
the pilot can connect to the OSPool and start executing jobs.</p>
<p>This technique is useful to implement <em>backfill</em> at a site:
contributing computing resources when they would otherwise be idle.</p>
<div class="admonition warning">
<p class="admonition-title">Container Limitations</p>
<p>These containers do not allow the site to share resources between multiple pools and,
if there are no matching idle jobs in the OSPool,
the pilots may remain idle.</p>
</div>
<h2 id="before-starting">Before Starting<a class="headerlink" href="#before-starting" title="Permanent link">&para;</a></h2>
<p>In order to configure the container, you will need:</p>
<ol>
<li>A system that can run containers, such as Docker or Kubernetes</li>
<li>Appropriate user permissions configured on the system.</li>
<li>Launching a container manually via docker requires membership in the <a href="https://docs.docker.com/engine/install/linux-postinstall/"><code>docker</code> group</a>.</li>
<li>Installing the container via RPM and launching it via systemd both require <code>root</code> privileges.</li>
<li>A scratch directory on the system must be writable by uid 1000.</li>
<li>A <a href="../../common/contact-registration/">registered administrative contact</a></li>
<li>A <a href="../../common/registration/">registered resource</a> in OSG Topology;
   resource registration allows OSG to do proper usage accounting and maintain contacts in case of security incidents
   and other issues.</li>
<li>An authentication token from the OSG: once contact and resource registration are complete, you can retrieve a token
   through the <a href="https://os-registry.opensciencegrid.org/">OSPool Token Registry</a></li>
<li>An <a href="../../data/run-frontier-squid-container/">HTTP caching proxy</a> at or near your site.</li>
</ol>
<h2 id="running-the-container-via-rpm">Running the Container via RPM<a class="headerlink" href="#running-the-container-via-rpm" title="Permanent link">&para;</a></h2>
<p>On EL hosts, the pilot container can also be managed via a systemctl service provided by the <code>ospool-ep</code> rpm. To install this RPM:</p>
<ol>
<li>
<p><a href="../../common/yum/">Enable OSG yum repos</a>.</p>
</li>
<li>
<p>Install the service:</p>
<div class="codehilite"><pre><span></span><code><span class="gp">root@host # </span>yum install ospool-ep
</code></pre></div>

</li>
<li>
<p><a href="https://os-registry.opensciencegrid.org/">Obtain an OSPool Access Token</a> for the pilot.</p>
</li>
<li>
<p>Copy the OSPool Access Token obtained in the previous step to <code>/etc/osg/ospool-ep.tkn</code>.</p>
<div class="admonition note">
<p class="admonition-title">Token file ownership</p>
<p>The EP is run under uid 1000.
Ensure this user has read access to the token file.</p>
<div class="codehilite"><pre><span></span><code><span class="gp">root@host # </span>chown <span class="m">1000</span>:1000 /etc/osg/ospool-ep.tkn
</code></pre></div>

</div>
</li>
<li>
<p>Configure the container service by editing <code>/etc/osg/ospool-ep.cfg</code>:</p>
<ul>
<li>Set <code>GLIDEIN_Site</code> to your OSG Topology Site identifier.</li>
<li>Set <code>GLIDEIN_ResourceName</code> to your OSG Topology Resource Name identifier.</li>
<li><strong>If</strong> you have dedicated scratch disk space for OSPool payload jobs (which is recommended),
  then set <code>WORKER_TEMP_DIR</code> to the scratch directory; e.g.:<div class="codehilite"><pre><span></span><code>WORKER_TEMP_DIR=/scratch
</code></pre></div>

</li>
</ul>
<p>Ensure that the directory is writable by uid 1000.</p>
<div class="admonition note">
<p class="admonition-title">Scratch space ownership</p>
<p>The EP is run under uid 1000.
Ensure this user has read, write, and execute access to the scratch space.</p>
</div>
</li>
<li>
<p><em>Optional:</em> Configure CVMFS via <code>/etc/osg/ospool-ep.cfg</code>:</p>
<ul>
<li>If <a href="https://osg-htc.org/docs/worker-node/install-cvmfs/">CVMFS is installed</a> on the host system,
  set <code>BIND_MOUNT_CVMFS=true</code></li>
<li>Otherwise, set <code>CVMFSEXEC_REPOS</code>, <code>CVMFS_HTTP_PROXY</code>, and <code>CVMFS_QUOTA_LIMIT</code> in accordance with the
  <a href="#cvmfsexec">Configure cvmfsexec</a> documentation.</li>
</ul>
</li>
<li>
<p>Configure additional variables in <code>/etc/osg/ospool-ep.cfg</code>:</p>
<ul>
<li>
<p>If your site has a <a href="https://osg-htc.org/docs/data/run-frontier-squid-container/">Squid HTTP Caching Proxy</a> configured,
  set <code>OSG_SQUID_LOCATION</code> to that proxy's HTTP address.</p>
</li>
<li>
<p>If providing NVIDIA GPU resources, set <code>PROVIDE_NVIDIA_GPU=true</code></p>
</li>
<li>This automatically sets variables in accordance with section <a href="#providing-gpu-resources">Providing GPU Resources</a>.</li>
</ul>
<div class="admonition note">
<p class="admonition-title">GPU Configuration Minimum Version</p>
<p>The first version of the ospool-ep RPM to provide support for GPU configuration is
24-2. Ensure your installation of the ospool-ep package is up to date using 
<code>yum update ospool-ep</code>.</p>
</div>
</li>
<li>
<p>Start the OSPool EP container service:</p>
<div class="codehilite"><pre><span></span><code><span class="gp">root@host # </span>systemctl start ospool-ep
</code></pre></div>

</li>
<li>
<p><em>Optional:</em> monitor the systemctl service logs to see if the container starts successfully:</p>
<div class="codehilite"><pre><span></span><code><span class="gp">root@host # </span>journalctl -f -u ospool-ep
</code></pre></div>

</li>
</ol>
<h2 id="running-the-container-with-docker">Running the Container with Docker<a class="headerlink" href="#running-the-container-with-docker" title="Permanent link">&para;</a></h2>
<p>The Docker image is kept in <a href="https://hub.docker.com/r/opensciencegrid/osgvo-docker-pilot">DockerHub</a>.
In order to successfully start payload jobs:</p>
<ol>
<li><strong>Configure authentication:</strong>
   Authentication with the OSPool is performed using tokens retrieved from the
   <a href="https://os-registry.opensciencegrid.org/">OSPool Token Registry</a>
   which you can then pass to the container by volume mounting it as a file under <code>/etc/condor/tokens-orig.d/</code>.
   If you are using Docker to launch the container, this is done with the command line flag
   <code>-v /path/to/token:/etc/condor/tokens-orig.d/flock.opensciencegrid.org</code>.
   Replace <code>/path/to/token</code> with the full path to the token you obtained from the OSPool Token Registry.</li>
<li>Set <code>GLIDEIN_Site</code> and <code>GLIDEIN_ResourceName</code> to match the resource group name and resource name that you registered
   in Topology, respectively.</li>
<li>Set the <code>OSG_SQUID_LOCATION</code> environment variable to the HTTP address of your preferred Squid instance.</li>
<li><em>If providing NVIDIA GPU resources:</em> See section <a href="#providing-gpu-resources">Providing GPU Resources</a></li>
<li>
<p><em>Strongly recommended:</em> If you want job I/O to be done in a separate directory outside of the container,
   volume mount the desired directory on the host to <code>/pilot</code> inside the container.</p>
<p>Without this, user jobs may compete for disk space with other containers on your system.</p>
<p>If you are using Docker to launch the container, this is done with the command line flag
<code>-v /worker-temp-dir:/pilot</code>.
Replace <code>/worker-temp-dir</code> with a directory you created for jobs to write into.
Make sure the user you run your container as has write access to this directory.</p>
</li>
<li>
<p><em>Optional:</em> add an expression with the <code>GLIDEIN_Start_Extra</code> environment variable to append to the
   <a href="https://htcondor.readthedocs.io/en/latest/admin-manual/ep-policy-configuration.html#the-start-expression">HTCondor <code>START</code> expression</a>;
   this limits the pilot to only run certain jobs.</p>
</li>
<li>
<p><em>Optional:</em> <a href="#limiting-resource-usage">limit OSG pilot container resource usage</a></p>
</li>
<li>
<p><em>Optional:</em> Enable <a href="#cvmfs">CVMFS</a> via one of the mechanisms described below.</p>
</li>
</ol>
<p>Here is an example invocation using <code>docker run</code> by hand:</p>
<div class="highlight"><pre><span></span><code>docker run -it --rm --user osg  \
       --pull=always            \
       --privileged             \
       -v /path/to/token:/etc/condor/tokens-orig.d/flock.opensciencegrid.org \
       -v /worker-temp-dir:/pilot               \
       -e GLIDEIN_Site=&quot;...&quot;                    \
       -e GLIDEIN_ResourceName=&quot;...&quot;            \
       -e GLIDEIN_Start_Extra=&quot;True&quot;            \
       -e OSG_SQUID_LOCATION=&quot;...&quot;              \
       -e CVMFSEXEC_REPOS=&quot;                     \
            oasis.opensciencegrid.org           \
            singularity.opensciencegrid.org&quot;    \
       hub.opensciencegrid.org/osg-htc/ospool-ep:24-release
</code></pre></div>
<p>Replace <code>/path/to/token</code> with the location you saved the token obtained from the OSPool Token Registry.
Privileged mode (<code>--privileged</code>) requested in the above <code>docker run</code> allows the container
to mount <a href="#cvmfsexec">CVMFS using cvmfsexec</a> and invoke <code>singularity</code> for user jobs.
Singularity (now known as Apptainer) allows OSPool users to use their own container for their job (e.g., a common use case for GPU jobs).</p>
<h2 id="optional-configuration">Optional Configuration<a class="headerlink" href="#optional-configuration" title="Permanent link">&para;</a></h2>
<h3 id="cvmfs">CVMFS<a class="headerlink" href="#cvmfs" title="Permanent link">&para;</a></h3>
<p><a href="https://cernvm.cern.ch/fs/">CernVM-FS</a> (CVMFS) is a read-only remote filesystem that some OSG jobs depend on for software and data.
Supporting CVMFS inside your container will increase the types of OSG jobs you can run.</p>
<p>There are two methods for making CVMFS available in your container: <a href="#cvmfsexec">enabling cvmfsexec</a>,
or <a href="#bind-mount">bind mounting CVMFS from the host</a>.
Bind mounting CVMFS will require CVMFS to be installed on the host first,
but the container will need fewer privileges.</p>
<h4 id="cvmfsexec">cvmfsexec<a class="headerlink" href="#cvmfsexec" title="Permanent link">&para;</a></h4>
<div class="admonition info">
<p class="admonition-title">cvmfsexec System Requirements</p>
<ul>
<li>
<p>On EL8, you must have kernel version &gt;= 4.18 (run <code>uname -vr</code> to check).</p>
</li>
<li>
<p>On EL9, all kernel versions &gt;= 5.0 should be supported.</p>
</li>
</ul>
<p>See the <a href="https://github.com/cvmfs/cvmfsexec#readme">cvmfsexec README</a> details.</p>
</div>
<p><a href="https://github.com/CVMFS/cvmfsexec#readme">cvmfsexec</a> is a tool that can be used to mount CVMFS inside the container
without requiring CVMFS on the host.
To enable cvmfsexec, specify a comma-separated list of repos in the <code>CVMFSEXEC_REPOS</code> environment variable.
Adding the following line to <code>/etc/osg/ospool-ep.cfg</code> will enable the repos we recommend:
<div class="highlight"><pre><span></span><code>CVMFSEXEC_REPOS=oasis.opensciencegrid.org,singularity.opensciencegrid.org
</code></pre></div></p>
<div class="admonition warning">
<p class="admonition-title">Systemd environment files</p>
<p>Systemd environment files do not honor shell syntax, i.e. variables are passed in directly as written</p>
</div>
<p>Additionally, you may set the following environment variables to further control the behavior of cvmfsexec:</p>
<ul>
<li>
<p><code>CVMFS_HTTP_PROXY</code> - this sets the proxy to use for CVMFS; if left blank
    it will find the best one via WLCG Web Proxy Auto Discovery.</p>
</li>
<li>
<p><code>CVMFS_QUOTA_LIMIT</code> - the quota limit in MB for CVMFS; leave this blank to
    use the system default (4 GB)</p>
</li>
</ul>
<p>You can add other CVMFS options by bind mounting a config file over <code>/cvmfsexec/default.local</code>;
note that options in environment variables take precedence over options in <code>/cvmfsexec/default.local</code>.</p>
<p>You may store the cache outside of the container by volume mounting a directory to <code>/cvmfs-cache</code>.
Similarly, logs may be stored outside of the container by volume mounting a directory to <code>/cvmfs-logs</code>.</p>
<h4 id="bind-mount">Bind mount<a class="headerlink" href="#bind-mount" title="Permanent link">&para;</a></h4>
<p>As an alternative to using cvmfsexec, you may <a href="../../worker-node/install-cvmfs/">install CVMFS</a> on the host,
and volume mount it into the container.
Containers with bind mounted CVMFS can be run without <code>--privileged</code> but still require the following capabilities:
<code>DAC_OVERRIDE</code>, <code>DAC_READ_SEARCH</code>, <code>SETGID</code>, <code>SETUID</code>, <code>SYS_ADMIN</code>, <code>SYS_CHROOT</code>, and <code>SYS_PTRACE</code>.</p>
<p>Once you have CVMFS installed and mounted on your host, add <code>-v /cvmfs:/cvmfs:shared</code> to your <code>docker run</code> invocation.
This is the <a href="#running-the-container-with-docker">example at the top of the page</a>,
modified to volume mount CVMFS instead of using cvmfsexec, and using reduced privileges:</p>
<div class="highlight"><pre><span></span><code>docker run -it --rm --user osg      \
        --pull=always            \
        --security-opt seccomp=unconfined \
        --security-opt systempaths=unconfined \
        --security-opt no-new-privileges \
<span class="hll">        -v /cvmfs:/cvmfs:shared     \
</span>        -v /path/to/token:/etc/condor/tokens-orig.d/flock.opensciencegrid.org \
        -v /worker-temp-dir:/pilot      \
        -e GLIDEIN_Site=&quot;...&quot;           \
        -e GLIDEIN_ResourceName=&quot;...&quot;   \
        -e GLIDEIN_Start_Extra=&quot;True&quot;   \
        -e OSG_SQUID_LOCATION=&quot;...&quot;     \
        hub.opensciencegrid.org/osg-htc/ospool-ep:24-release
</code></pre></div>
<p>Fill in the values for <code>/path/to/token</code>, <code>/worker-temp-dir</code>, <code>GLIDEIN_Site</code>, <code>GLIDEIN_ResourceName</code>, and <code>OSG_SQUID_LOCATION</code> <a href="#running-the-container-with-docker">as above</a>.</p>
<h3 id="providing-gpu-resources">Providing GPU Resources<a class="headerlink" href="#providing-gpu-resources" title="Permanent link">&para;</a></h3>
<p>By default, the container will not detect NVIDIA GPU resources available on its host. To configure
the container for access to its host’s GPU resources, set the following:</p>
<ol>
<li>
<p>Replace the default <code>24-release</code> docker image tag with the <a href="https://developer.nvidia.com/cuda-toolkit">CUDA-enabled</a>
   <code>24-cuda-11_8_0-release</code> tag</p>
</li>
<li>
<p>Bind-mount <code>/etc/OpenCL/vendors</code>, read-only. If you are using Docker to launch the container, 
   this is done with the command line flags <code>-v /etc/OpenCL/vendors:/etc/OpenCL/vendors:ro</code>.</p>
</li>
<li>
<p>The NVIDIA runtime is known to conflict with Singularity <a href="https://man7.org/linux/man-pages/man7/pid_namespaces.7.html">PID Namespaces</a>
   Disable PID namespaces by adding the flag <code>-e SINGULARITY_DISABLE_PID_NAMESPACES=True</code></p>
</li>
</ol>
<p>This is the <a href="#running-the-container-with-docker">example at the top of the page</a>, modified
to provide NVIDIA GPU resources:</p>
<div class="highlight"><pre><span></span><code>docker run -it --rm --user osg  \
       --pull=always            \
       --privileged             \
       -v /path/to/token:/etc/condor/tokens-orig.d/flock.opensciencegrid.org \
       -v /worker-temp-dir:/pilot               \
<span class="hll">       -v /etc/OpenCL/vendors:/etc/OpenCL/vendors:ro \
</span>       -e GLIDEIN_Site=&quot;...&quot;                    \
       -e GLIDEIN_ResourceName=&quot;...&quot;            \
       -e GLIDEIN_Start_Extra=&quot;True&quot;            \
       -e OSG_SQUID_LOCATION=&quot;...&quot;              \
<span class="hll">       -e SINGULARITY_DISABLE_PID_NAMESPACES=True   \
</span><span class="hll">       hub.opensciencegrid.org/osg-htc/ospool-ep:24-cuda_11_8_0-release
</span></code></pre></div>
<h3 id="limiting-resource-usage">Limiting resource usage<a class="headerlink" href="#limiting-resource-usage" title="Permanent link">&para;</a></h3>
<p>By default, the container allows jobs to utilize the entire node's resources (CPUs, memory).
To limit a container's resource consumptions, you may specify limits, which must be set in the following ways:</p>
<ul>
<li>As environment variables, limiting the resources the pilot offers to jobs.</li>
<li>As options to the <code>docker run</code> command, limiting the resources the pilot container can use.</li>
</ul>
<h4 id="cpus">CPUs<a class="headerlink" href="#cpus" title="Permanent link">&para;</a></h4>
<p>To limit the number of CPUs available to jobs (thus limiting the number of simultaneous jobs),
add the following to your <code>docker run</code> command:</p>
<div class="highlight"><pre><span></span><code>   -e NUM_CPUS=&lt;X&gt;  --cpus=&lt;X&gt; \
</code></pre></div>
<p>where <code>&lt;X&gt;</code> is the number of CPUs you want to allow jobs to use.</p>
<p>The <code>NUM_CPUS</code> environment variable tells the pilot not to offer more than the given number of CPUs to jobs;
the <code>--cpus</code> argument tells Docker not to allocate more than the given number of CPUs to the container.</p>
<h4 id="memory">Memory<a class="headerlink" href="#memory" title="Permanent link">&para;</a></h4>
<p>To limit the total amount of memory available to jobs, add the following to your <code>docker run</code> command:</p>
<div class="highlight"><pre><span></span><code>    -e MEMORY=&lt;X&gt; --memory=$(( (&lt;X&gt; + 100) * 1024 * 1024 )) \
</code></pre></div>
<p>where <code>&lt;X&gt;</code> is the total amount of memory (in MB) you want to allow jobs to use.</p>
<p>The <code>MEMORY</code> environment variable tells the pilot not to offer more than the given amount of memory to jobs;
the <code>--memory</code> argument tells Docker to kill the container if its total memory usage exceeds the given number.</p>
<div class="admonition tip">
<p class="admonition-title">Allocating additional memory</p>
<p>Note that the above command will allocate 100 MB more memory to the container.
The pilot will place jobs on hold if they exceed their requested memory,
but it may not notice high memory usage immediately.
Additionally, the processes that manage jobs also use some amount of memory.
Therefore, it is important to give the container some extra room.</p>
</div>
<h3 id="advanced-advertising-additional-pilot-attributes">Advanced: Advertising additional pilot attributes<a class="headerlink" href="#advanced-advertising-additional-pilot-attributes" title="Permanent link">&para;</a></h3>
<p>You can put arbitrary additional attributes in the machine ads that the pilot advertises to the OSPool.
These attributes will show up when users run <code>condor_status -l</code> against your pilot.
This could be useful for advertising something about the way the pilot was provisioned.
To do this, volume-mount a file containing <code>key=value</code> pairs to <code>/etc/osg/extra-attributes.cfg</code>.
Keys must be valid classad attribute names and values must be valid classad expressions.
Multi-line strings are not supported.
A line starting with <code>#</code> will be treated as a comment.
For example:</p>
<div class="highlight"><pre><span></span><code># The Kubernetes namespace this pod is running under
KUBERNETES_NAMESPACE = &quot;path-osgdev&quot;
# The deployment for this pilot
KUBERNETES_DEPLOYMENT = &quot;osgvo-docker-pilot-gpu&quot;
</code></pre></div>
<h2 id="best-practices">Best Practices<a class="headerlink" href="#best-practices" title="Permanent link">&para;</a></h2>
<p>We recommend pulling new versions of backfill containers at least every 72 hours.
This ensures that your containers will have the latest bug and security fixes as well as the configurations to match the
rest of the OSPool.
Additionally, you may see better utilization of your resources as the OSPool may ignore resources with a high number of
job starts.</p>
<h2 id="getting-help">Getting Help<a class="headerlink" href="#getting-help" title="Permanent link">&para;</a></h2>
<p>For assistance, please use the <a href="../../common/help/">this page</a>.</p>

              
            </article>
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" data-md-state="hidden">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../overview/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Overview" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Overview
            </div>
          </div>
        </a>
      
      
        
        <a href="../user-containers/" class="md-footer__link md-footer__link--next" aria-label="Next: User Allocations" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              User Allocations
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div>
    This material is based upon work supported by the
    <a href="https://nsf.gov">National Science Foundation</a>
    under Grant Nos.
    <a href="https://www.nsf.gov/awardsearch/showAward?AWD_ID=1148698">1148698</a>
    ,
    <a href="https://www.nsf.gov/awardsearch/showAward?AWD_ID=1836650">1836650</a>
    , and
    <a href="https://www.nsf.gov/awardsearch/showAward?AWD_ID=2030508">2030508</a>
    . Any opinions, findings, and conclusions or recommendations expressed in this material are those of the author(s) and do not necessarily reflect the views of the National Science Foundation.
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
        Material for MkDocs
    </a>
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.sections", "navigation.top"], "search": "../../assets/javascripts/workers/search.5e67fbfe.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.c44cc438.min.js"></script>
      
    
  </body>
</html>