
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://osg-htc.org/docs/other/troubleshooting-gratia/">
      
      <link rel="icon" href="../../img/favicon.ico">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.2.8">
    
    
      
        <title>Troubleshooting Gratia Accounting - OSG Site Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.644de097.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  


  <script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-69012-29","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){var e;this.value&&(e=document.location.pathname,ga("send","pageview",e+"?q="+this.value))}),"undefined"!=typeof location$&&location$.subscribe(function(e){ga("send","pageview",e.pathname)})})</script>
  <script async src="https://www.google-analytics.com/analytics.js"></script>


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#troubleshooting-gratia-accounting" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="OSG Site Documentation" class="md-header__button md-logo" aria-label="OSG Site Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            OSG Site Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Troubleshooting Gratia Accounting
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/osg-htc/docs/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="OSG Site Documentation" class="md-nav__button md-logo" aria-label="OSG Site Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    OSG Site Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/osg-htc/docs/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../site-planning/" class="md-nav__link">
        Site Planning
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../common/registration/" class="md-nav__link">
        Registration
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../site-verification/" class="md-nav__link">
        Site Verification
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../site-maintenance/" class="md-nav__link">
        Site Maintenance
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../common/help/" class="md-nav__link">
        Help / Security Incidents
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_7">
          Resource Sharing
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Resource Sharing" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Resource Sharing
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_1" type="checkbox" id="__nav_7_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7_1">
          Compute
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Compute" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_1">
          <span class="md-nav__icon md-icon"></span>
          Compute
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../resource-sharing/overview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_1_2" type="checkbox" id="__nav_7_1_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7_1_2">
          Pilot Containers
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Pilot Containers" data-md-level="3">
        <label class="md-nav__title" for="__nav_7_1_2">
          <span class="md-nav__icon md-icon"></span>
          Pilot Containers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../resource-sharing/os-backfill-containers/" class="md-nav__link">
        Site Backfill
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../resource-sharing/user-containers/" class="md-nav__link">
        User Allocations
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_1_3" type="checkbox" id="__nav_7_1_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7_1_3">
          Compute Entrypoint
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Compute Entrypoint" data-md-level="3">
        <label class="md-nav__title" for="__nav_7_1_3">
          <span class="md-nav__icon md-icon"></span>
          Compute Entrypoint
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../compute-element/htcondor-ce-overview/" class="md-nav__link">
        HTCondor-CE Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../compute-element/hosted-ce/" class="md-nav__link">
        Request a Hosted CE
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../compute-element/install-htcondor-ce/" class="md-nav__link">
        Install HTCondor-CE
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_1_4" type="checkbox" id="__nav_7_1_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7_1_4">
          Worker Node
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Worker Node" data-md-level="3">
        <label class="md-nav__title" for="__nav_7_1_4">
          <span class="md-nav__icon md-icon"></span>
          Worker Node
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../worker-node/using-wn/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../worker-node/install-wn/" class="md-nav__link">
        Install from RPM
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../worker-node/install-wn-tarball/" class="md-nav__link">
        Install from Tarball
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../worker-node/install-wn-oasis/" class="md-nav__link">
        Install from OASIS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../worker-node/install-cvmfs/" class="md-nav__link">
        Install CVMFS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../worker-node/install-singularity/" class="md-nav__link">
        Install Singularity
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../worker-node/using-wn-containers/" class="md-nav__link">
        Using WN Containers
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_2" type="checkbox" id="__nav_7_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7_2">
          Data
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Data" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_2">
          <span class="md-nav__icon md-icon"></span>
          Data
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_2_1" type="checkbox" id="__nav_7_2_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7_2_1">
          HTTP & OASIS
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="HTTP & OASIS" data-md-level="3">
        <label class="md-nav__title" for="__nav_7_2_1">
          <span class="md-nav__icon md-icon"></span>
          HTTP & OASIS
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/run-frontier-squid-container/" class="md-nav__link">
        Running Frontier Squid in a Container
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/frontier-squid/" class="md-nav__link">
        Install Frontier Squid RPM
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/update-oasis/" class="md-nav__link">
        Update OASIS Shared Repo
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/external-oasis-repos/" class="md-nav__link">
        Install an OASIS Repo
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_2_2" type="checkbox" id="__nav_7_2_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7_2_2">
          XRootD
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="XRootD" data-md-level="3">
        <label class="md-nav__title" for="__nav_7_2_2">
          <span class="md-nav__icon md-icon"></span>
          XRootD
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/xrootd/overview/" class="md-nav__link">
        XRootD Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/xrootd/install-standalone/" class="md-nav__link">
        Install XRootD Standalone
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/xrootd/install-storage-element/" class="md-nav__link">
        Install XRootD SE
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/xrootd/xrootd-authorization/" class="md-nav__link">
        Configure Authorization
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/xrootd/install-client/" class="md-nav__link">
        Using XRootD
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/xrootd/install-cms-xcache/" class="md-nav__link">
        Install CMS XCache
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/xrootd/install-shoveler/" class="md-nav__link">
        Install XRootD Shoveler
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_3" type="checkbox" id="__nav_7_3" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_7_3">
          Other
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Other" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_3">
          <span class="md-nav__icon md-icon"></span>
          Other
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../configuration-with-osg-configure/" class="md-nav__link">
        Configuration with OSG-Configure
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../install-gwms-frontend/" class="md-nav__link">
        Install GlideinWMS Frontend
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../install-cvmfs-stratum1/" class="md-nav__link">
        Install a CVMFS Stratum 1
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Troubleshooting Gratia
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Troubleshooting Gratia
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#accounting-architecture" class="md-nav__link">
    Accounting Architecture
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#determine-your-host-type" class="md-nav__link">
    Determine Your Host Type
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#is-gratia-running" class="md-nav__link">
    Is Gratia Running?
  </a>
  
    <nav class="md-nav" aria-label="Is Gratia Running?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#identifying-failures" class="md-nav__link">
    Identifying failures
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verifying-packaging" class="md-nav__link">
    Verifying packaging
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verifying-configuration" class="md-nav__link">
    Verifying configuration
  </a>
  
    <nav class="md-nav" aria-label="Verifying configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#htcondor-configuration" class="md-nav__link">
    HTCondor configuration
  </a>
  
    <nav class="md-nav" aria-label="HTCondor configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#access-points" class="md-nav__link">
    Access Points
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#htcondor-ce-and-htcondor-batch-systems" class="md-nav__link">
    HTCondor-CE and HTCondor batch systems
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#htcondor-ce-and-non-htcondor-batch-systems" class="md-nav__link">
    HTCondor-CE and non-HTCondor batch systems
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gratia-probeconfig" class="md-nav__link">
    Gratia ProbeConfig
  </a>
  
    <nav class="md-nav" aria-label="Gratia ProbeConfig">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#access-points_1" class="md-nav__link">
    Access Points
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compute-entrypoints" class="md-nav__link">
    Compute Entrypoints
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#have-records-been-uploaded-to-the-gracc" class="md-nav__link">
    Have Records Been Uploaded To the GRACC?
  </a>
  
    <nav class="md-nav" aria-label="Have Records Been Uploaded To the GRACC?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#have-you-configured-the-resource-names-correctly" class="md-nav__link">
    Have you configured the resource names correctly?
  </a>
  
    <nav class="md-nav" aria-label="Have you configured the resource names correctly?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#access-points_2" class="md-nav__link">
    Access Points
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compute-entrypoints_1" class="md-nav__link">
    Compute Entrypoints
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#did-the-site-name-change" class="md-nav__link">
    Did the site name change?
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reference" class="md-nav__link">
    Reference
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../schedd-filebeats/" class="md-nav__link">
        Install Transfer Log Filebeats
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../osg-token-renewer/" class="md-nav__link">
        Install OSG Token Renewal Service
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      
      
      
        <label class="md-nav__link" for="__nav_8">
          Access Point
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Access Point" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Access Point
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../submit/osg-flock/" class="md-nav__link">
        Install an OSPool Access Point
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../submit/ap-ospool-aup/" class="md-nav__link">
        Acceptable Use Policy
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9" type="checkbox" id="__nav_9" >
      
      
      
      
        <label class="md-nav__link" for="__nav_9">
          Data Federation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Data Federation" data-md-level="1">
        <label class="md-nav__title" for="__nav_9">
          <span class="md-nav__icon md-icon"></span>
          Data Federation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/stashcache/overview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_2" type="checkbox" id="__nav_9_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_9_2">
          Data Cache
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Data Cache" data-md-level="2">
        <label class="md-nav__title" for="__nav_9_2">
          <span class="md-nav__icon md-icon"></span>
          Data Cache
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/stashcache/run-stashcache-container/" class="md-nav__link">
        Install from container
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/stashcache/install-cache/" class="md-nav__link">
        Install from RPM
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_3" type="checkbox" id="__nav_9_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_9_3">
          Data Origin
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Data Origin" data-md-level="2">
        <label class="md-nav__title" for="__nav_9_3">
          <span class="md-nav__icon md-icon"></span>
          Data Origin
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/stashcache/run-stash-origin-container/" class="md-nav__link">
        Install from container
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/stashcache/install-origin/" class="md-nav__link">
        Install from RPM
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/stashcache/vo-data/" class="md-nav__link">
        Publishing VO data
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_10" type="checkbox" id="__nav_10" >
      
      
      
      
        <label class="md-nav__link" for="__nav_10">
          Releases
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Releases" data-md-level="1">
        <label class="md-nav__title" for="__nav_10">
          <span class="md-nav__icon md-icon"></span>
          Releases
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../release/release_series/" class="md-nav__link">
        Release Series
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_10_2" type="checkbox" id="__nav_10_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_10_2">
          OSG 3.6
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="OSG 3.6" data-md-level="2">
        <label class="md-nav__title" for="__nav_10_2">
          <span class="md-nav__icon md-icon"></span>
          OSG 3.6
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../release/osg-36/" class="md-nav__link">
        News
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../release/updating-to-osg-36/" class="md-nav__link">
        Updating to OSG 3.6
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../release/supported_platforms/" class="md-nav__link">
        Supported Platforms
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../common/yum/" class="md-nav__link">
        OSG Yum Repos
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../release/yum-basics/" class="md-nav__link">
        Yum Basics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../release/signing/" class="md-nav__link">
        RPM Signing
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_11" type="checkbox" id="__nav_11" >
      
      
      
      
        <label class="md-nav__link" for="__nav_11">
          Tokens
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Tokens" data-md-level="1">
        <label class="md-nav__title" for="__nav_11">
          <span class="md-nav__icon md-icon"></span>
          Tokens
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../security/tokens/overview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../security/tokens/using-tokens/" class="md-nav__link">
        Using Tokens
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_12" type="checkbox" id="__nav_12" >
      
      
      
      
        <label class="md-nav__link" for="__nav_12">
          CA Certificates
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="CA Certificates" data-md-level="1">
        <label class="md-nav__title" for="__nav_12">
          <span class="md-nav__icon md-icon"></span>
          CA Certificates
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../common/ca/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../security/certificate-management/" class="md-nav__link">
        Certificate Management Reference
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_12_3" type="checkbox" id="__nav_12_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_12_3">
          Host Certificates
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Host Certificates" data-md-level="2">
        <label class="md-nav__title" for="__nav_12_3">
          <span class="md-nav__icon md-icon"></span>
          Host Certificates
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../security/host-certs/overview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../security/host-certs/incommon/" class="md-nav__link">
        Using InCommon
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../security/host-certs/lets-encrypt/" class="md-nav__link">
        Using Let's Encrypt
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#accounting-architecture" class="md-nav__link">
    Accounting Architecture
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#determine-your-host-type" class="md-nav__link">
    Determine Your Host Type
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#is-gratia-running" class="md-nav__link">
    Is Gratia Running?
  </a>
  
    <nav class="md-nav" aria-label="Is Gratia Running?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#identifying-failures" class="md-nav__link">
    Identifying failures
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verifying-packaging" class="md-nav__link">
    Verifying packaging
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verifying-configuration" class="md-nav__link">
    Verifying configuration
  </a>
  
    <nav class="md-nav" aria-label="Verifying configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#htcondor-configuration" class="md-nav__link">
    HTCondor configuration
  </a>
  
    <nav class="md-nav" aria-label="HTCondor configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#access-points" class="md-nav__link">
    Access Points
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#htcondor-ce-and-htcondor-batch-systems" class="md-nav__link">
    HTCondor-CE and HTCondor batch systems
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#htcondor-ce-and-non-htcondor-batch-systems" class="md-nav__link">
    HTCondor-CE and non-HTCondor batch systems
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gratia-probeconfig" class="md-nav__link">
    Gratia ProbeConfig
  </a>
  
    <nav class="md-nav" aria-label="Gratia ProbeConfig">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#access-points_1" class="md-nav__link">
    Access Points
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compute-entrypoints" class="md-nav__link">
    Compute Entrypoints
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#have-records-been-uploaded-to-the-gracc" class="md-nav__link">
    Have Records Been Uploaded To the GRACC?
  </a>
  
    <nav class="md-nav" aria-label="Have Records Been Uploaded To the GRACC?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#have-you-configured-the-resource-names-correctly" class="md-nav__link">
    Have you configured the resource names correctly?
  </a>
  
    <nav class="md-nav" aria-label="Have you configured the resource names correctly?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#access-points_2" class="md-nav__link">
    Access Points
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compute-entrypoints_1" class="md-nav__link">
    Compute Entrypoints
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#did-the-site-name-change" class="md-nav__link">
    Did the site name change?
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reference" class="md-nav__link">
    Reference
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
<a href="https://github.com/osg-htc/docs/edit/master/docs/other/troubleshooting-gratia.md" title="Edit this page" class="md-content__button md-icon">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
</a>



<h1 id="troubleshooting-gratia-accounting">Troubleshooting Gratia Accounting<a class="headerlink" href="#troubleshooting-gratia-accounting" title="Permanent link">&para;</a></h1>
<p>Gratia is software used in OSG to gather accounting information for usage of computational resources.
This information is collected from individual services at a site,
such as a Compute Entrypoint (CE) or an Access Point (AP),
through "Gratia probes" and transferred to the central OSG GRACC server.</p>
<p>Gratia probes are run periodically as cron jobs under an HTCondor Schedd process (i.e., Schedd cron jobs) as the
<code>condor</code> user.
The commands that you run, configuration locations that you verify, and log locations that you check will depend on the
type of host that you are troubleshooting.</p>
<h2 id="accounting-architecture">Accounting Architecture<a class="headerlink" href="#accounting-architecture" title="Permanent link">&para;</a></h2>
<p><img alt="Gratia Basics" src="../../img/gratia-overview.png" /></p>
<p>These are the definitions of the major elements in the above figure.</p>
<ul>
<li><strong>Gratia probe</strong>: A piece of software that collects accounting data from the host on which it's running, and
    transmits it to the GRACC server.</li>
<li><strong>GRACC server</strong>: A server that collects Gratia accounting data from one or more sites and can share it with users
    via a web page.
    The GRACC server is hosted by the OSG.</li>
<li><strong>Reporter</strong>: A web service running on the GRACC server.
    Users can connect to the reporter via a web browser to explore the Gratia data.</li>
<li><strong>Collector</strong>: A web service running on the GRACC server that collects data from one or more Gratia probes.
    Users do not directly interact with the collector.</li>
</ul>
<p>You can explore the details of the OSG accounting data at <a href="https://gracc.opensciencegrid.org">https://gracc.opensciencegrid.org</a> and
<a href="https://display.opensciencegrid.org/">https://display.opensciencegrid.org/</a>.</p>
<h2 id="determine-your-host-type">Determine Your Host Type<a class="headerlink" href="#determine-your-host-type" title="Permanent link">&para;</a></h2>
<p>Before continuing with the rest of the document, it is important to know what type of host you are troubleshooting:</p>
<ul>
<li>Do users log into this host and submit jobs? Then you are running an <strong>Access Point</strong></li>
<li>Does this host accept pilot jobs from remote clients? Then you are running a <strong>Compute Entrypoint</strong></li>
</ul>
<p>If you are still not sure, you can run the following command to determine if this is a CE installation:</p>
<div class="highlight"><pre><span></span><code><span class="gp">$ </span>rpm -q osg-ce
<span class="go">osg-ce-3.6-4.osg36.el7.x86_64</span>
</code></pre></div>
<p>If the output is blank, then you are not working with a CE host.</p>
<div class="admonition note">
<p class="admonition-title">Access Points vs Compute Entrypoints</p>
<p>A single host should not be used as both an AP and a CE but if you've inherited a host,
it's possible that the host was installed improperly.</p>
</div>
<h2 id="is-gratia-running">Is Gratia Running?<a class="headerlink" href="#is-gratia-running" title="Permanent link">&para;</a></h2>
<p>Since Gratia probes run as Schedd cron jobs, first verify that the relevant HTCondor service is running based on the
type of host that you are troubleshooting:</p>
<table>
<thead>
<tr>
<th align="left"><strong>Host</strong></th>
<th><strong>Command</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Access Point</td>
<td><code>systemctl status condor</code></td>
</tr>
<tr>
<td align="left">Compute Entrypoint</td>
<td><code>systemctl status condor-ce</code></td>
</tr>
</tbody>
</table>
<p>If they are not running, consult the relevant documentation to enable and start the appropriate service:</p>
<ul>
<li><a href="../../submit/osg-flock/#managing-services">Access Point</a></li>
<li><a href="https://htcondor.com/htcondor-ce/v5/operation/#managing-htcondor-ce-services">Compute Entrypoint</a></li>
</ul>
<h3 id="identifying-failures">Identifying failures<a class="headerlink" href="#identifying-failures" title="Permanent link">&para;</a></h3>
<p>Schedd cron jobs are logged to the SchedLog, whose location depends on the type of host you are troubleshooting:</p>
<table>
<thead>
<tr>
<th align="left"><strong>Host</strong></th>
<th><strong>Log Path</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Access Point</td>
<td><code>/var/log/condor/SchedLog</code></td>
</tr>
<tr>
<td align="left">Compute Entrypoint</td>
<td><code>/var/log/condor-ce/SchedLog</code></td>
</tr>
</tbody>
</table>
<p>Currently, the default log level does not show Schedd cron job activity (future releases will show failures by default)
so you must perform the following steps to see the relevant log messages:</p>
<ol>
<li>
<p>Identify the configuration location for your host:</p>
<table>
<thead>
<tr>
<th align="left"><strong>Host</strong></th>
<th><strong>Configuration Directory</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Access Point</td>
<td><code>/etc/condor/config.d</code></td>
</tr>
<tr>
<td align="left">Compute Entrypoint</td>
<td><code>/etc/condor-ce/config.d</code></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>In a <code>.conf</code> file in the configuration directory that you determined above, increase the debug level:</p>
<div class="codehilite"><pre><span></span><code>SCHEDD_DEBUG = $(SCHEDD_DEBUG) D_CAT D_ALWAYS:2
</code></pre></div>

</li>
</ol>
<p>Successful cron jobs will appear in the relevant <code>SchedLog</code> like so: </p>
<div class="highlight"><pre><span></span><code>05/06/22 19:25:31 (D_ALWAYS:2) CronJob: Starting job &#39;GRATIA&#39; (/usr/share/gratia/htcondor-ce/condor_meter)
05/06/22 19:25:31 (D_ALWAYS:2) Create_Process: using fast clone() to create child process.
05/06/22 19:25:31 (D_ALWAYS:2) CronJob: STDOUT closed for &#39;GRATIA&#39;
05/06/22 19:25:31 (D_ALWAYS:2) CronJob: STDERR closed for &#39;GRATIA&#39;
05/06/22 19:25:31 (D_ALWAYS:2) CronJob: &#39;GRATIA&#39; (pid 1082) exit_status=0
05/06/22 19:25:31 (D_ALWAYS:2) CronJob::Schedule &#39;GRATIA&#39; IR=F IP=T IWE=F IOS=F IOD=F nr=116 nf=0
05/06/22 19:25:31 (D_ALWAYS:2) CronJob::Schedule &#39;GRATIA_CLEANUP&#39; IR=F IP=T IWE=F IOS=F IOD=F nr=2 nf=0
</code></pre></div>
<h3 id="verifying-packaging">Verifying packaging<a class="headerlink" href="#verifying-packaging" title="Permanent link">&para;</a></h3>
<p>Gratia probe RPM packaging will create the appropriate files and folder structure with the correct permissions so that
Gratia probes can run smoothly.
However, it's possible that stale configuration management or other automation scripts at your site could 
To verify that file contents and ownership have not been changed, run one of the following commands based on the type of
host you are troubleshooting:</p>
<table>
<thead>
<tr>
<th align="left"><strong>Host</strong></th>
<th><strong>Command</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Access Point</td>
<td><code>rpm -q --verify gratia-probe-condor-ap</code></td>
</tr>
<tr>
<td align="left">Compute Entrypoint</td>
<td><code>rpm -q --verify gratia-probe-htcondor-ce</code></td>
</tr>
</tbody>
</table>
<h3 id="verifying-configuration">Verifying configuration<a class="headerlink" href="#verifying-configuration" title="Permanent link">&para;</a></h3>
<p>When troubleshooting Gratia, there are two different configurations to investigate:</p>
<ul>
<li><a href="#htcondor-configuration">HTCondor configuration</a> if job history records aren't being processed.</li>
<li><a href="#gratia-probeconfig">Gratia ProbeConfig</a> if your job history records are being processed but they are either
    malformed or are not being sent to the GRACC</li>
</ul>
<h4 id="htcondor-configuration">HTCondor configuration<a class="headerlink" href="#htcondor-configuration" title="Permanent link">&para;</a></h4>
<p>The HTCondor and/or HTCondor-CE configuration determines where job history files are written and how often the Gratia
probe Schedd cron job are run.
If you recently updated your host to OSG 3.6, it's important to verify the location of the job history files.</p>
<h5 id="access-points">Access Points<a class="headerlink" href="#access-points" title="Permanent link">&para;</a></h5>
<p>Verify the values of your HTCondor <code>PER_JOB_HISTORY_DIR</code> configurations match the output below:</p>
<div class="highlight"><pre><span></span><code><span class="gp"># </span>condor_config_val -v PER_JOB_HISTORY_DIR
<span class="go">PER_JOB_HISTORY_DIR = /var/lib/condor/gratia/data</span>
<span class="gp"> # </span>at: /usr/share/condor/config.d/50-gratia-gwms.conf, line <span class="m">28</span>
<span class="gp"> # </span>raw: <span class="nv">PER_JOB_HISTORY_DIR</span> <span class="o">=</span> /var/lib/condor/gratia/data
</code></pre></div>
<ul>
<li>
<p><strong>If you see the above output</strong>, your Gratia Probe configuration is correct and you may continue onto the
  <a href="#gratia-probeconfig">next section</a>.</p>
</li>
<li>
<p><strong>If you do not see the above output</strong>:</p>
<ol>
<li>
<p>If the value of <code>condor_config_val -v PER_JOB_HISTORY_DIR</code> is not <code>/var/lib/condor/gratia/data</code>
    note its value.
    Then visit the referenced file, remove the offending configuration and repeat until the output of
    <code>condor_config_val -v PER_JOB_HISTORY_DIR</code> matches the above output.</p>
</li>
<li>
<p>If you noted a different value in step a, copy data from the old directory to the new directory and fix ensure
    that ownership is correct:</p>
<div class="codehilite"><pre><span></span><code><span class="gp">root@host # </span>cp  &lt;ORIGINAL DIR&gt;/* /var/lib/condor/gratia/data/
<span class="gp">root@host # </span>chown -R condor:condor /var/lib/condor/gratia/data/
</code></pre></div>

<p>Replacing <code>&lt;ORIGINAL_DIR&gt;</code> with the value that you noted in step a.</p>
</li>
</ol>
</li>
</ul>
<h5 id="htcondor-ce-and-htcondor-batch-systems">HTCondor-CE and HTCondor batch systems<a class="headerlink" href="#htcondor-ce-and-htcondor-batch-systems" title="Permanent link">&para;</a></h5>
<p>Verify the values of your HTCondor and HTCondor-CE <code>PER_JOB_HISTORY_DIR</code> configurations match the output below:</p>
<div class="highlight"><pre><span></span><code><span class="gp"># </span>condor_ce_config_val -v PER_JOB_HISTORY_DIR
<span class="go">Not defined: PER_JOB_HISTORY_DIR</span>
<span class="gp"> # </span>at: &lt;Default&gt;
<span class="gp"> # </span>raw: <span class="nv">PER_JOB_HISTORY_DIR</span> <span class="o">=</span> 

<span class="gp"># </span>condor_config_val -v PER_JOB_HISTORY_DIR
<span class="go">PER_JOB_HISTORY_DIR = /var/lib/condor-ce/gratia/data</span>
<span class="gp"> # </span>at: /etc/condor/config.d/99-gratia.conf, line <span class="m">5</span>
<span class="gp"> # </span>raw: <span class="nv">PER_JOB_HISTORY_DIR</span> <span class="o">=</span> /var/lib/condor-ce/gratia/data
</code></pre></div>
<ul>
<li>
<p><strong>If you see the above output</strong>, your Gratia Probe configuration is correct and you may continue onto the
  <a href="#gratia-probeconfig">next section</a>.</p>
</li>
<li>
<p><strong>If you do not see the above output</strong>:</p>
<ol>
<li>
<p>If the value of <code>condor_config_val -v PER_JOB_HISTORY_DIR</code> is not <code>/var/lib/condor-ce/gratia/data</code>
    note its value.
    Then visit the referenced file, remove the offending configuration and repeat until the output of
    <code>condor_config_val -v PER_JOB_HISTORY_DIR</code> matches the above output.</p>
</li>
<li>
<p>If the value of <code>condor_ce_config_val -v PER_JOB_HISTORY_DIR</code> is set,
    visit the referenced file and remove the offending configuration.
    Repeat until the output of <code>condor_ce_config_val -v PER_JOB_HISTORY_DIR</code> matches the above output.</p>
</li>
<li>
<p>If you noted a different value in step a, copy data from the old directory to the new directory and fix ensure
    that ownership is correct:</p>
<div class="codehilite"><pre><span></span><code><span class="gp">root@host # </span>cp  &lt;ORIGINAL DIR&gt;/* /var/lib/condor-ce/gratia/data/
<span class="gp">root@host # </span>chown -R condor:condor /var/lib/condor-ce/gratia/data/
</code></pre></div>

<p>Replacing <code>&lt;ORIGINAL_DIR&gt;</code> with the value that you noted in step a.</p>
</li>
</ol>
</li>
</ul>
<h5 id="htcondor-ce-and-non-htcondor-batch-systems">HTCondor-CE and non-HTCondor batch systems<a class="headerlink" href="#htcondor-ce-and-non-htcondor-batch-systems" title="Permanent link">&para;</a></h5>
<p>After updating your <code>gratia-probe-*</code> packages,
verify that your HTCondor-CE's <code>PER_JOB_HISTORY_DIR</code> is set to <code>/var/lib/condor-ce/gratia/data</code>:</p>
<div class="highlight"><pre><span></span><code><span class="gp">root@host # </span>condor_ce_config_val -v PER_JOB_HISTORY_DIR
<span class="go">PER_JOB_HISTORY_DIR = /var/lib/condor-ce/gratia/data</span>
<span class="gp"># </span>at: /etc/condor-ce/config.d/99_gratia-ce.conf, line <span class="m">5</span>
<span class="gp"># </span>raw: <span class="nv">PER_JOB_HISTORY_DIR</span> <span class="o">=</span> /var/lib/condor-ce/gratia/data
</code></pre></div>
<ul>
<li>
<p><strong>If you see the above output</strong>, your Gratia Probe configuration is correct and you may continue onto the
  <a href="#gratia-probeconfig">next section</a>.</p>
</li>
<li>
<p><strong>If you do not see the above output</strong>, visit the file listed in the output of <code>condor_ce_config_val</code>, remove the
  offending value, and repeat until the proper value is returned.</p>
</li>
</ul>
<h3 id="gratia-probeconfig">Gratia ProbeConfig<a class="headerlink" href="#gratia-probeconfig" title="Permanent link">&para;</a></h3>
<h4 id="access-points_1">Access Points<a class="headerlink" href="#access-points_1" title="Permanent link">&para;</a></h4>
<p>Verify that your Gratia configuration is correct in <code>/etc/gratia/condor-ap/ProbeConfig</code> based on the table below:</p>
<ol>
<li>
<p>Fill in the value for <code>SiteName</code> with the Resource Name you registered in Topology (see
    <a href="../../submit/osg-flock/#register-your-access-point-in-osg-topology">this section</a> for details).
    For example:</p>
<div class="codehilite"><pre><span></span><code>SiteName=&quot;OSG_US_EXAMPLE_SUBMIT&quot;
</code></pre></div>

</li>
<li>
<p>Set the ProbeName:</p>
<div class="codehilite"><pre><span></span><code>ProbeName=&quot;condor-ap:<span class="nt">&lt;HOST_FQDN&gt;</span>&quot;
</code></pre></div>

<p>Replacing <code>&lt;HOST_FQDN&gt;</code> with your access point's fully qualifed domain name</p>
</li>
<li>
<p>Enable the Gratia Probe:</p>
<div class="codehilite"><pre><span></span><code>EnableProbe=&quot;1&quot;
</code></pre></div>

</li>
<li>
<p>If you are updating an existing ProbeConfig from a pre-OSG 3.6 installation,
    also ensure that the following values are set:</p>
<table>
<thead>
<tr>
<th align="left">Option</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>VOOverrides</code></td>
<td>The collaboration's resource pool of your AP, e.g. <code>osg</code> for an OSPool AP</td>
</tr>
<tr>
<td align="left"><code>SuppressGridLocalRecords</code></td>
<td><code>"1"</code></td>
</tr>
<tr>
<td align="left"><code>MapUnknownToGroup</code></td>
<td><code>"1"</code></td>
</tr>
<tr>
<td align="left"><code>DataFolder</code></td>
<td><code>"/var/lib/condor/gratia/data/"</code></td>
</tr>
<tr>
<td align="left"><code>WorkingFolder</code></td>
<td><code>"/var/lib/condor/gratia/tmp/"</code></td>
</tr>
<tr>
<td align="left"><code>LogFolder</code></td>
<td><code>"/var/log/condor/gratia/"</code></td>
</tr>
</tbody>
</table>
</li>
</ol>
<h4 id="compute-entrypoints">Compute Entrypoints<a class="headerlink" href="#compute-entrypoints" title="Permanent link">&para;</a></h4>
<p>In normal cases, <code>osg-configure</code> manages the relevant ProbeConfig and it can be configured by modifying
<code>/etc/osg/config.d/30-gratia.ini</code>.
Consult the <a href="../configuration-with-osg-configure/#gratia">osg-configuration documentation</a> for details.</p>
<p>If there are problems or special configuration, you might need to edit the Gratia configuration files yourself by
modifying <code>/etc/gratia/htcondor-ce/ProbeConfig</code>.</p>
<p>The ProbeConfig files have many details.
A few options that you might need to edit are shown before.
This is <strong>not</strong> a complete file, but only shows a subset of the options.</p>
<div class="highlight"><pre><span></span><code>&lt;ProbeConfiguration 

    CollectorHost=&quot;gratia-osg-itb.opensciencegrid.org:80&quot;
    SSLHost=&quot;gratia-osg-itb.opensciencegrid.org:80&quot;
    SSLRegistrationHost=&quot;gratia-osg-itb.opensciencegrid.org:80&quot;

    ProbeName=&quot;htcondor-ce:fermicloud084.fnal.gov&quot;
    SiteName=&quot;WISC_OSG_EDU&quot;
    EnableProbe=&quot;1&quot;
/&gt;
</code></pre></div>
<p>The options you see here are:</p>
<table>
<thead>
<tr>
<th align="left">Option</th>
<th align="left">Comments</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">CollectorHost</td>
<td align="left">The GRACC server this probe reports to</td>
</tr>
<tr>
<td align="left">SSLHost</td>
<td align="left">The GRACC server this probe reports to</td>
</tr>
<tr>
<td align="left">SSLRegistrationHost</td>
<td align="left">The GRACC server this probe reports to</td>
</tr>
<tr>
<td align="left">ProbeName</td>
<td align="left">The unique name for this probe. Note that it includes the probe type and the host name</td>
</tr>
<tr>
<td align="left">SiteName</td>
<td align="left">The name of your Resource, as registered in <a href="../../common/registration/">OSG Topology</a>.</td>
</tr>
<tr>
<td align="left">EnableProbe</td>
<td align="left">The probe will only run if this is "1"</td>
</tr>
</tbody>
</table>
<p>Again, there are many more options in this file. Most of the time you won't need to touch them.</p>
<h2 id="have-records-been-uploaded-to-the-gracc">Have Records Been Uploaded To the GRACC?<a class="headerlink" href="#have-records-been-uploaded-to-the-gracc" title="Permanent link">&para;</a></h2>
<p>If you have verified that your <a href="#is-gratia-running">Gratia probe is running</a> and you are receiving pilot jobs,
you should see data in the GRACC for your service approximately 24h after jobs have completed successfully by entering
your Topology-registered site name into the <code>Facility</code> dropdown:</p>
<ul>
<li><a href="https://gracc.opensciencegrid.org/d/000000037/payload-jobs-summary?orgId=1">Access Points</a></li>
<li><a href="https://gracc.opensciencegrid.org/d/000000043/pilot-jobs-summary?orgId=1">Compute Entrypoints</a></li>
</ul>
<p>If you still aren't seeing data in GRACC, use this section to ensure that your resources are registered properly.</p>
<h3 id="have-you-configured-the-resource-names-correctly">Have you configured the resource names correctly?<a class="headerlink" href="#have-you-configured-the-resource-names-correctly" title="Permanent link">&para;</a></h3>
<h4 id="access-points_2">Access Points<a class="headerlink" href="#access-points_2" title="Permanent link">&para;</a></h4>
<p>Ensure that <code>SiteName</code> in your ProbeConfig matches your Topology-registered resource name.
See <a href="#access-points_1">this section</a> for details</p>
<h4 id="compute-entrypoints_1">Compute Entrypoints<a class="headerlink" href="#compute-entrypoints_1" title="Permanent link">&para;</a></h4>
<p>Do the names of your resources match the names in
<a href="https://github.com/opensciencegrid/topology/tree/master/topology">OSG Topology</a>?
Gratia retrieves the resource name from the <code>Site Information</code> section of the <code>/etc/osg/config.d/40-siteinfo.ini</code></p>
<div class="highlight"><pre><span></span><code>;===================================================================
;                       Site Information
;===================================================================

[Site Information]
; Set &quot;group&quot; to &quot;OSG&quot; for a production site, or &quot;OSG-ITB&quot; for an ITB site.
; 
; YOU WILL NEED TO CHANGE THIS
group = OSG

; Set &quot;host_name&quot; to the host name of the CE being configured.
; This should resolve in DNS; if DNS is not set up yet, enter an IPv4/v6 address instead.
;
; YOU WILL NEED TO CHANGE THIS
host_name = tusker-gw1.unl.edu

; Set &quot;resource&quot; to the name of the resource that you have registered
; in the OSG topology repository at https://github.com/opensciencegrid/topology
; 
; YOU WILL NEED TO CHANGE THIS
resource = Tusker-CE1
</code></pre></div>
<p>Do those names match the names that you registered with OSG Topology?
If not, edit the names, and rerun "osg-configure -c".</p>
<h3 id="did-the-site-name-change">Did the site name change?<a class="headerlink" href="#did-the-site-name-change" title="Permanent link">&para;</a></h3>
<p>Was the site previously reporting data, but the registered Topology site name changed?
When the site name changes, you need to ask the GRACC operations team to update the name of your site at the GRACC
collector:</p>
<ol>
<li>Open a <a href="https://support.opensciencegrid.org/helpdesk/tickets/new">support ticket</a></li>
<li>Select "Software or Service"</li>
<li>Select "GRACC Operations"</li>
<li>Write a friendly email that asks the GRACC team to change your site name at the collector.
    Make sure to tell them the old name and the new name:<div class="codehilite"><pre><span></span><code>Hello GRACC Team,

Please change the site name of my site from &lt;OLD NAME&gt; to &lt;NEW NAME&gt;.

Thanks, ...
</code></pre></div>

</li>
</ol>
<h2 id="reference">Reference<a class="headerlink" href="#reference" title="Permanent link">&para;</a></h2>
<p>If you need to look for more data, consider consulting some of the relevant files here:</p>
<table>
<thead>
<tr>
<th align="left">File</th>
<th align="left">Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>/var/log/condor/gratia/&lt;DATE&gt;.log</code> or <code>/var/log/condor-ce/gratia/&lt;DATE&gt;.log</code></td>
<td align="left">Log file that records information about processing and uploading of Gratia accounting data</td>
</tr>
<tr>
<td align="left"><code>/var/lib/condor/gratia/data</code> or <code>/var/lib/condor-ce/gratia/data</code></td>
<td align="left">Location for AP and CE job data before being processed by Gratia<br>HTCondor or HTCondor-CE's <code>PER_JOB_HISTORY_DIR</code> should be set to this location</td>
</tr>
<tr>
<td align="left"><code>/var/lib/condor/gratia/tmp</code> or <code>/var/lib/condor-ce/gratia/tmp</code></td>
<td align="left">Location for temporary Gratia data as it is being processed, usually empty.<br>If you have files that are more than 30 minutes old in this directory, there may be a problem</td>
</tr>
<tr>
<td align="left"><code>/etc/gratia/condor-ap/ProbeConfig</code> or <code>/etc/gratia/htcondor-ce/ProbeConfig</code></td>
<td align="left">Configuration for Gratia probes</td>
</tr>
</tbody>
</table>
<p>Not all RPMs will be on all hosts.
Instead, only the <code>gratia-probe-common</code> and the one RPM specific to that host will be installed.
The most common RPMs you will see are:</p>
<table>
<thead>
<tr>
<th align="left">RPM</th>
<th align="left">Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>gratia-probe-common</code></td>
<td align="left">Code shared between all Gratia probes</td>
</tr>
<tr>
<td align="left"><code>gratia-probe-condor</code></td>
<td align="left">An empty probe to ease updates from OSG 3.5 to OSG 3.6. Can be safely removed</td>
</tr>
<tr>
<td align="left"><code>gratia-probe-condor-ap</code></td>
<td align="left">The probe that tracks Access Point usage</td>
</tr>
<tr>
<td align="left"><code>gratia-probe-htcondor-ce</code></td>
<td align="left">Probe that tracks HTCondor-CE usage</td>
</tr>
</tbody>
</table>

              
            </article>
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" data-md-state="hidden">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../install-cvmfs-stratum1/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Install a CVMFS Stratum 1" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Install a CVMFS Stratum 1
            </div>
          </div>
        </a>
      
      
        
        <a href="../schedd-filebeats/" class="md-footer__link md-footer__link--next" aria-label="Next: Install Transfer Log Filebeats" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Install Transfer Log Filebeats
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div>
    This material is based upon work supported by the
    <a href="https://nsf.gov">National Science Foundation</a>
    under Grant Nos.
    <a href="https://www.nsf.gov/awardsearch/showAward?AWD_ID=1148698">1148698</a>
    ,
    <a href="https://www.nsf.gov/awardsearch/showAward?AWD_ID=1836650">1836650</a>
    , and
    <a href="https://www.nsf.gov/awardsearch/showAward?AWD_ID=2030508">2030508</a>
    . Any opinions, findings, and conclusions or recommendations expressed in this material are those of the author(s) and do not necessarily reflect the views of the National Science Foundation.
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
        Material for MkDocs
    </a>
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.sections", "navigation.top"], "search": "../../assets/javascripts/workers/search.5e67fbfe.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.c44cc438.min.js"></script>
      
    
  </body>
</html>